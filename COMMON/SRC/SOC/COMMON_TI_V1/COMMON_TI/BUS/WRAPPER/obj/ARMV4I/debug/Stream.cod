; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\COMMON_TI\BUS\WRAPPER\Stream.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?Release@RefCount_t@@QAAJXZ|		; RefCount_t::Release
	EXPORT	|Init|
	IMPORT	|?CreateDevice@Driver_t@@SAPAV1@XZ|	; Driver_t::CreateDevice

  00000			 AREA	 |.pdata|, PDATA
|$T35724| DCD	|$LN6@Init|
	DCD	0x40002204
; Function compile flags: /Odtp
; File c:\wince600\platform\common\src\soc\common_ti_v1\common_ti\bus\wrapper\stream.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |Init|	 PROC

; 24   : {

  00000		 |$LN6@Init|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d0003	 stmdb       sp!, {r0, r1}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd010	 sub         sp, sp, #0x10
  00010		 |$M35721|

; 25   :     Driver_t *pDevice;
; 26   : 
; 27   :     // Create bus driver
; 28   :     pDevice = Driver_t::CreateDevice();

  00010	eb000000	 bl          |?CreateDevice@Driver_t@@SAPAV1@XZ|
  00014	e58d0008	 str         r0, [sp, #8]
  00018	e59d3008	 ldr         r3, [sp, #8]
  0001c	e58d3000	 str         r3, [sp]

; 29   :     if ((pDevice != NULL) && !pDevice->Init(activeRegName, pBusContext))

  00020	e59d3000	 ldr         r3, [sp]
  00024	e3530000	 cmp         r3, #0
  00028	0a000010	 beq         |$LN1@Init|
  0002c	e59d201c	 ldr         r2, [sp, #0x1C]
  00030	e59d1018	 ldr         r1, [sp, #0x18]
  00034	e59d3000	 ldr         r3, [sp]
  00038	e5933000	 ldr         r3, [r3]
  0003c	e2833004	 add         r3, r3, #4
  00040	e59d0000	 ldr         r0, [sp]
  00044	e5933000	 ldr         r3, [r3]
  00048	e1a0e00f	 mov         lr, pc
  0004c	e12fff13	 bx          r3
  00050	e58d000c	 str         r0, [sp, #0xC]
  00054	e59d300c	 ldr         r3, [sp, #0xC]
  00058	e3530000	 cmp         r3, #0
  0005c	1a000003	 bne         |$LN1@Init|

; 30   :         {
; 31   :         pDevice->Release();

  00060	e59d0000	 ldr         r0, [sp]
  00064	eb000000	 bl          |?Release@RefCount_t@@QAAJXZ|

; 32   :         pDevice = NULL;

  00068	e3a03000	 mov         r3, #0
  0006c	e58d3000	 str         r3, [sp]
  00070		 |$LN1@Init|

; 33   :         }
; 34   :     return reinterpret_cast<DWORD>(pDevice);

  00070	e59d3000	 ldr         r3, [sp]
  00074	e58d3004	 str         r3, [sp, #4]

; 35   : }

  00078	e59d0004	 ldr         r0, [sp, #4]
  0007c	e28dd010	 add         sp, sp, #0x10
  00080	e89d6000	 ldmia       sp, {sp, lr}
  00084	e12fff1e	 bx          lr
  00088		 |$M35722|

			 ENDP  ; |Init|

	IMPORT	|InterlockedDecrement|
; File c:\wince600\platform\common\src\soc\common_ti_v1\common_ti\bus\inc\driver.hxx

  00000			 AREA	 |.pdata|, PDATA
|$T35734| DCD	|$LN8@Release|
	DCD	0x40002704
; Function compile flags: /Odtp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?Release@RefCount_t@@QAAJXZ| PROC	; RefCount_t::Release

; 59   :         ) {

  00000		 |$LN8@Release|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d0001	 stmdb       sp!, {r0}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd01c	 sub         sp, sp, #0x1C
  00010		 |$M35731|

; 60   :         LONG count = InterlockedDecrement(&m_refCount);

  00010	e59d3024	 ldr         r3, [sp, #0x24]
  00014	e2830004	 add         r0, r3, #4
  00018	eb000000	 bl          InterlockedDecrement
  0001c	e58d0010	 str         r0, [sp, #0x10]
  00020	e59d3010	 ldr         r3, [sp, #0x10]
  00024	e58d3000	 str         r3, [sp]

; 61   :         if (count <= 0) delete this;

  00028	e59d3000	 ldr         r3, [sp]
  0002c	e3530000	 cmp         r3, #0
  00030	ca000013	 bgt         |$LN1@Release|
  00034	e59d3024	 ldr         r3, [sp, #0x24]
  00038	e58d3008	 str         r3, [sp, #8]
  0003c	e59d3008	 ldr         r3, [sp, #8]
  00040	e58d3004	 str         r3, [sp, #4]
  00044	e59d3004	 ldr         r3, [sp, #4]
  00048	e3530000	 cmp         r3, #0
  0004c	0a00000a	 beq         |$LN4@Release|
  00050	e3a01001	 mov         r1, #1
  00054	e59d3004	 ldr         r3, [sp, #4]
  00058	e5933000	 ldr         r3, [r3]
  0005c	e59d0004	 ldr         r0, [sp, #4]
  00060	e5933000	 ldr         r3, [r3]
  00064	e1a0e00f	 mov         lr, pc
  00068	e12fff13	 bx          r3
  0006c	e58d0014	 str         r0, [sp, #0x14]
  00070	e59d3014	 ldr         r3, [sp, #0x14]
  00074	e58d3018	 str         r3, [sp, #0x18]
  00078	ea000001	 b           |$LN5@Release|
  0007c		 |$LN4@Release|
  0007c	e3a03000	 mov         r3, #0
  00080	e58d3018	 str         r3, [sp, #0x18]
  00084		 |$LN5@Release|
  00084		 |$LN1@Release|

; 62   :         return count;

  00084	e59d3000	 ldr         r3, [sp]
  00088	e58d300c	 str         r3, [sp, #0xC]

; 63   :         };

  0008c	e59d000c	 ldr         r0, [sp, #0xC]
  00090	e28dd01c	 add         sp, sp, #0x1C
  00094	e89d6000	 ldmia       sp, {sp, lr}
  00098	e12fff1e	 bx          lr
  0009c		 |$M35732|

			 ENDP  ; |?Release@RefCount_t@@QAAJXZ|, RefCount_t::Release

	EXPORT	|Deinit|

  00008			 AREA	 |.pdata|, PDATA
|$T35742| DCD	|$LN5@Deinit|
	DCD	0x40001a04
; Function compile flags: /Odtp
; File c:\wince600\platform\common\src\soc\common_ti_v1\common_ti\bus\wrapper\stream.cpp

  00088			 AREA	 |.text|, CODE, ARM

  00088		 |Deinit| PROC

; 44   : {

  00088		 |$LN5@Deinit|
  00088	e1a0c00d	 mov         r12, sp
  0008c	e92d0001	 stmdb       sp!, {r0}
  00090	e92d5000	 stmdb       sp!, {r12, lr}
  00094	e24dd010	 sub         sp, sp, #0x10
  00098		 |$M35739|

; 45   :     BOOL rc = FALSE;

  00098	e3a03000	 mov         r3, #0
  0009c	e58d3004	 str         r3, [sp, #4]

; 46   :     Driver_t *pDevice = reinterpret_cast<Driver_t*>(context);

  000a0	e59d3018	 ldr         r3, [sp, #0x18]
  000a4	e58d3000	 str         r3, [sp]

; 47   :     rc = pDevice->Deinit();

  000a8	e59d3000	 ldr         r3, [sp]
  000ac	e5933000	 ldr         r3, [r3]
  000b0	e2833008	 add         r3, r3, #8
  000b4	e59d0000	 ldr         r0, [sp]
  000b8	e5933000	 ldr         r3, [r3]
  000bc	e1a0e00f	 mov         lr, pc
  000c0	e12fff13	 bx          r3
  000c4	e58d000c	 str         r0, [sp, #0xC]
  000c8	e59d300c	 ldr         r3, [sp, #0xC]
  000cc	e58d3004	 str         r3, [sp, #4]

; 48   :     pDevice->Release();

  000d0	e59d0000	 ldr         r0, [sp]
  000d4	eb000000	 bl          |?Release@RefCount_t@@QAAJXZ|

; 49   :     return rc;

  000d8	e59d3004	 ldr         r3, [sp, #4]
  000dc	e58d3008	 str         r3, [sp, #8]

; 50   : }

  000e0	e59d0008	 ldr         r0, [sp, #8]
  000e4	e28dd010	 add         sp, sp, #0x10
  000e8	e89d6000	 ldmia       sp, {sp, lr}
  000ec	e12fff1e	 bx          lr
  000f0		 |$M35740|

			 ENDP  ; |Deinit|

	EXPORT	|PowerUp|

  00010			 AREA	 |.pdata|, PDATA
|$T35747| DCD	|$LN5@PowerUp|
	DCD	0x40001004
; Function compile flags: /Odtp

  000f0			 AREA	 |.text|, CODE, ARM

  000f0		 |PowerUp| PROC

; 59   : {

  000f0		 |$LN5@PowerUp|
  000f0	e1a0c00d	 mov         r12, sp
  000f4	e92d0001	 stmdb       sp!, {r0}
  000f8	e92d5000	 stmdb       sp!, {r12, lr}
  000fc	e24dd004	 sub         sp, sp, #4
  00100		 |$M35744|

; 60   :     Driver_t *pDevice = reinterpret_cast<Driver_t*>(context);

  00100	e59d300c	 ldr         r3, [sp, #0xC]
  00104	e58d3000	 str         r3, [sp]

; 61   :     pDevice->PowerUp();

  00108	e59d3000	 ldr         r3, [sp]
  0010c	e5933000	 ldr         r3, [r3]
  00110	e2833010	 add         r3, r3, #0x10
  00114	e59d0000	 ldr         r0, [sp]
  00118	e5933000	 ldr         r3, [r3]
  0011c	e1a0e00f	 mov         lr, pc
  00120	e12fff13	 bx          r3

; 62   : }

  00124	e28dd004	 add         sp, sp, #4
  00128	e89d6000	 ldmia       sp, {sp, lr}
  0012c	e12fff1e	 bx          lr
  00130		 |$M35745|

			 ENDP  ; |PowerUp|

	EXPORT	|PowerDown|

  00018			 AREA	 |.pdata|, PDATA
|$T35752| DCD	|$LN5@PowerDown|
	DCD	0x40001004
; Function compile flags: /Odtp

  00130			 AREA	 |.text|, CODE, ARM

  00130		 |PowerDown| PROC

; 71   : {

  00130		 |$LN5@PowerDown|
  00130	e1a0c00d	 mov         r12, sp
  00134	e92d0001	 stmdb       sp!, {r0}
  00138	e92d5000	 stmdb       sp!, {r12, lr}
  0013c	e24dd004	 sub         sp, sp, #4
  00140		 |$M35749|

; 72   :     Driver_t *pDevice = reinterpret_cast<Driver_t*>(context);

  00140	e59d300c	 ldr         r3, [sp, #0xC]
  00144	e58d3000	 str         r3, [sp]

; 73   :     pDevice->PowerDown();

  00148	e59d3000	 ldr         r3, [sp]
  0014c	e5933000	 ldr         r3, [r3]
  00150	e2833014	 add         r3, r3, #0x14
  00154	e59d0000	 ldr         r0, [sp]
  00158	e5933000	 ldr         r3, [r3]
  0015c	e1a0e00f	 mov         lr, pc
  00160	e12fff13	 bx          r3

; 74   : }

  00164	e28dd004	 add         sp, sp, #4
  00168	e89d6000	 ldmia       sp, {sp, lr}
  0016c	e12fff1e	 bx          lr
  00170		 |$M35750|

			 ENDP  ; |PowerDown|

	EXPORT	|Open|

  00020			 AREA	 |.pdata|, PDATA
|$T35758| DCD	|$LN5@Open|
	DCD	0x40001804
; Function compile flags: /Odtp

  00170			 AREA	 |.text|, CODE, ARM

  00170		 |Open|	 PROC

; 85   : {

  00170		 |$LN5@Open|
  00170	e1a0c00d	 mov         r12, sp
  00174	e92d0007	 stmdb       sp!, {r0 - r2}
  00178	e92d5000	 stmdb       sp!, {r12, lr}
  0017c	e24dd010	 sub         sp, sp, #0x10
  00180		 |$M35755|

; 86   :     Driver_t* pDevice = reinterpret_cast<Driver_t*>(context);

  00180	e59d3018	 ldr         r3, [sp, #0x18]
  00184	e58d3000	 str         r3, [sp]

; 87   :     DriverContext_t* pContext = pDevice->Open(accessCode, shareMode);

  00188	e59d2020	 ldr         r2, [sp, #0x20]
  0018c	e59d101c	 ldr         r1, [sp, #0x1C]
  00190	e59d3000	 ldr         r3, [sp]
  00194	e5933000	 ldr         r3, [r3]
  00198	e2833018	 add         r3, r3, #0x18
  0019c	e59d0000	 ldr         r0, [sp]
  001a0	e5933000	 ldr         r3, [r3]
  001a4	e1a0e00f	 mov         lr, pc
  001a8	e12fff13	 bx          r3
  001ac	e58d000c	 str         r0, [sp, #0xC]
  001b0	e59d300c	 ldr         r3, [sp, #0xC]
  001b4	e58d3004	 str         r3, [sp, #4]

; 88   :     return reinterpret_cast<DWORD>(pContext);

  001b8	e59d3004	 ldr         r3, [sp, #4]
  001bc	e58d3008	 str         r3, [sp, #8]

; 89   : }

  001c0	e59d0008	 ldr         r0, [sp, #8]
  001c4	e28dd010	 add         sp, sp, #0x10
  001c8	e89d6000	 ldmia       sp, {sp, lr}
  001cc	e12fff1e	 bx          lr
  001d0		 |$M35756|

			 ENDP  ; |Open|

	EXPORT	|Close|

  00028			 AREA	 |.pdata|, PDATA
|$T35764| DCD	|$LN5@Close|
	DCD	0x40001a04
; Function compile flags: /Odtp

  001d0			 AREA	 |.text|, CODE, ARM

  001d0		 |Close| PROC

; 98   : {

  001d0		 |$LN5@Close|
  001d0	e1a0c00d	 mov         r12, sp
  001d4	e92d0001	 stmdb       sp!, {r0}
  001d8	e92d5000	 stmdb       sp!, {r12, lr}
  001dc	e24dd010	 sub         sp, sp, #0x10
  001e0		 |$M35761|

; 99   :     BOOL rc = FALSE;

  001e0	e3a03000	 mov         r3, #0
  001e4	e58d3000	 str         r3, [sp]

; 100  :     DriverContext_t* pContext = reinterpret_cast<DriverContext_t*>(context);

  001e8	e59d3018	 ldr         r3, [sp, #0x18]
  001ec	e58d3004	 str         r3, [sp, #4]

; 101  :     rc = pContext->Close();

  001f0	e59d3004	 ldr         r3, [sp, #4]
  001f4	e5933000	 ldr         r3, [r3]
  001f8	e2833010	 add         r3, r3, #0x10
  001fc	e59d0004	 ldr         r0, [sp, #4]
  00200	e5933000	 ldr         r3, [r3]
  00204	e1a0e00f	 mov         lr, pc
  00208	e12fff13	 bx          r3
  0020c	e58d000c	 str         r0, [sp, #0xC]
  00210	e59d300c	 ldr         r3, [sp, #0xC]
  00214	e58d3000	 str         r3, [sp]

; 102  :     pContext->Release();

  00218	e59d0004	 ldr         r0, [sp, #4]
  0021c	eb000000	 bl          |?Release@RefCount_t@@QAAJXZ|

; 103  :     return rc;

  00220	e59d3000	 ldr         r3, [sp]
  00224	e58d3008	 str         r3, [sp, #8]

; 104  : }

  00228	e59d0008	 ldr         r0, [sp, #8]
  0022c	e28dd010	 add         sp, sp, #0x10
  00230	e89d6000	 ldmia       sp, {sp, lr}
  00234	e12fff1e	 bx          lr
  00238		 |$M35762|

			 ENDP  ; |Close|

	EXPORT	|IOControl|

  00030			 AREA	 |.pdata|, PDATA
|$T35773| DCD	|$LN5@IOControl|
	DCD	0x40001d04
; Function compile flags: /Odtp

  00238			 AREA	 |.text|, CODE, ARM

  00238		 |IOControl| PROC

; 119  : {

  00238		 |$LN5@IOControl|
  00238	e1a0c00d	 mov         r12, sp
  0023c	e92d000f	 stmdb       sp!, {r0 - r3}
  00240	e92d5010	 stmdb       sp!, {r4, r12, lr}
  00244	e24dd024	 sub         sp, sp, #0x24
  00248		 |$M35770|

; 120  :     DriverContext_t* pContext = reinterpret_cast<DriverContext_t*>(context);

  00248	e59d3030	 ldr         r3, [sp, #0x30]
  0024c	e58d300c	 str         r3, [sp, #0xC]

; 121  :     return pContext->IOControl(
; 122  :         code, pInBuffer, inSize, pOutBuffer, outSize, pOutSize
; 123  :         );

  00250	e59d3048	 ldr         r3, [sp, #0x48]
  00254	e58d3008	 str         r3, [sp, #8]
  00258	e59d3044	 ldr         r3, [sp, #0x44]
  0025c	e58d3004	 str         r3, [sp, #4]
  00260	e59d3040	 ldr         r3, [sp, #0x40]
  00264	e58d3000	 str         r3, [sp]
  00268	e59d303c	 ldr         r3, [sp, #0x3C]
  0026c	e59d2038	 ldr         r2, [sp, #0x38]
  00270	e59d1034	 ldr         r1, [sp, #0x34]
  00274	e59d000c	 ldr         r0, [sp, #0xC]
  00278	e5900000	 ldr         r0, [r0]
  0027c	e280e018	 add         lr, r0, #0x18
  00280	e59d000c	 ldr         r0, [sp, #0xC]
  00284	e59e4000	 ldr         r4, [lr]
  00288	e1a0e00f	 mov         lr, pc
  0028c	e12fff14	 bx          r4
  00290	e58d0020	 str         r0, [sp, #0x20]
  00294	e59d3020	 ldr         r3, [sp, #0x20]
  00298	e58d301c	 str         r3, [sp, #0x1C]

; 124  : }

  0029c	e59d001c	 ldr         r0, [sp, #0x1C]
  002a0	e28dd024	 add         sp, sp, #0x24
  002a4	e89d6010	 ldmia       sp, {r4, sp, lr}
  002a8	e12fff1e	 bx          lr
  002ac		 |$M35771|

			 ENDP  ; |IOControl|

	END
