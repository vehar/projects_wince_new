; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\COMMON_TI\OAL\OMAP_IOCTL\reboot.c
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "


  00000			 AREA	 |.rdata|, DATA, READONLY
|EdbgVendorIds| DCW 0x0
	DCW	0x0
	DCD	0x4033
	DCB	0x1
	DCB	"AD", 0x0
	DCW	0x1050
	DCW	0x940
	DCD	0x4005
	DCB	0x1
	DCB	"LS", 0x0
	DCW	0x1050
	DCW	0x940
	DCD	0x2078
	DCB	0x1
	DCB	"LS", 0x0
	DCW	0x10ec
	DCW	0x8029
	DCD	0xc0f0
	DCB	0x1
	DCB	"KS", 0x0
	DCW	0x10ec
	DCW	0x8129
	DCD	0x0
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0x900b
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0xd0c9
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0xe04c
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x1186
	DCW	0x1300
	DCD	0x50ba
	DCB	0x4
	DCB	"DL", 0x0
	DCW	0x100b
	DCW	0x20
	DCD	0xa0cc
	DCB	0x5
	DCB	"NG", 0x0
	DCW	0x10b7
	DCW	0x9050
	DCD	0x6008
	DCB	0x6
	DCB	"3C", 0x0
	DCW	0x10b7
	DCW	0x9200
	DCD	0x476
	DCB	0x6
	DCB	"3C", 0x0
	EXPORT	|??_C@_1CK@MAHBEPGM@?$AA?9?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CA@PEBMPEHG@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAR?$AAE?$AAS?$AAE?$AAT?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CK@LAAGFJIK@?$AA?$CL?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|OALIoCtlHalReboot|
	IMPORT	|PrcmGlobalReset|
	IMPORT	|OEMCacheRangeFlush|
	IMPORT	|g_pContextRestore|
	IMPORT	|KITLIoctl|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|dpCurSettings|

  00000			 AREA	 |.pdata|, PDATA
|$T45317| DCD	|$LN9@OALIoCtlHa|
	DCD	0x40006704
; File c:\wince600\platform\common\src\soc\common_ti_v1\common_ti\oal\omap_ioctl\reboot.c

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CK@MAHBEPGM@?$AA?9?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@| DCB "-"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "I", 0x0, "o", 0x0, "C"
	DCB	0x0, "t", 0x0, "l", 0x0, "H", 0x0, "a", 0x0, "l", 0x0, "R"
	DCB	0x0, "e", 0x0, "b", 0x0, "o", 0x0, "o", 0x0, "t", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CA@PEBMPEHG@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAR?$AAE?$AAS?$AAE?$AAT?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@| DCB "*"
	DCB	0x0, "*", 0x0, "*", 0x0, " ", 0x0, "R", 0x0, "E", 0x0, "S"
	DCB	0x0, "E", 0x0, "T", 0x0, " ", 0x0, "*", 0x0, "*", 0x0, "*"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CK@LAAGFJIK@?$AA?$CL?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@| DCB "+"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "I", 0x0, "o", 0x0, "C"
	DCB	0x0, "t", 0x0, "l", 0x0, "H", 0x0, "a", 0x0, "l", 0x0, "R"
	DCB	0x0, "e", 0x0, "b", 0x0, "o", 0x0, "o", 0x0, "t", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Odtp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |OALIoCtlHalReboot| PROC

; 39   : {    

  00000		 |$LN9@OALIoCtlHa|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d000f	 stmdb       sp!, {r0 - r3}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd020	 sub         sp, sp, #0x20
  00010		 |$M45314|

; 40   :     BOOL    bPowerOn = FALSE;

  00010	e3a03000	 mov         r3, #0
  00014	e58d3008	 str         r3, [sp, #8]

; 41   : 
; 42   :     UNREFERENCED_PARAMETER(inpSize);
; 43   :     UNREFERENCED_PARAMETER(pInpBuffer);
; 44   :     UNREFERENCED_PARAMETER(code);
; 45   :     UNREFERENCED_PARAMETER(pOutSize);
; 46   :     UNREFERENCED_PARAMETER(outSize);
; 47   :     UNREFERENCED_PARAMETER(pOutBuffer);
; 48   : 
; 49   :     OALMSG(OAL_IOCTL&&OAL_FUNC, (L"+OALIoCtlHalReboot\r\n"));

  00018	e59f3168	 ldr         r3, [pc, #0x168]
  0001c	e5933440	 ldr         r3, [r3, #0x440]
  00020	e3130a01	 tst         r3, #1, 20
  00024	0a000008	 beq         |$LN3@OALIoCtlHa|
  00028	e59f3158	 ldr         r3, [pc, #0x158]
  0002c	e5933440	 ldr         r3, [r3, #0x440]
  00030	e3130004	 tst         r3, #4
  00034	0a000004	 beq         |$LN3@OALIoCtlHa|
  00038	e59f0158	 ldr         r0, [pc, #0x158]
  0003c	eb000000	 bl          NKDbgPrintfW
  00040	e3a03001	 mov         r3, #1
  00044	e58d3018	 str         r3, [sp, #0x18]
  00048	ea000001	 b           |$LN4@OALIoCtlHa|
  0004c		 |$LN3@OALIoCtlHa|
  0004c	e3a03000	 mov         r3, #0
  00050	e58d3018	 str         r3, [sp, #0x18]
  00054		 |$LN4@OALIoCtlHa|

; 50   : 
; 51   :     // Perform a global SW reset
; 52   :     OALMSG(TRUE, (L"*** RESET ***\r\n"));

  00054	e59f0138	 ldr         r0, [pc, #0x138]
  00058	eb000000	 bl          NKDbgPrintfW

; 53   : 
; 54   :     // Disable KITL
; 55   : #if (_WINCEOSVER<600)
; 56   :     OALKitlPowerOff();
; 57   : #else    
; 58   :     KITLIoctl(IOCTL_KITL_POWER_CALL, &bPowerOn, sizeof(bPowerOn), NULL, 0, NULL);    

  0005c	e3a03000	 mov         r3, #0
  00060	e58d3004	 str         r3, [sp, #4]
  00064	e3a03000	 mov         r3, #0
  00068	e58d3000	 str         r3, [sp]
  0006c	e3a03000	 mov         r3, #0
  00070	e3a02004	 mov         r2, #4
  00074	e28d1008	 add         r1, sp, #8
  00078	e59f0110	 ldr         r0, [pc, #0x110]
  0007c	eb000000	 bl          KITLIoctl

; 59   : #endif
; 60   : 
; 61   :     // Clear context registers
; 62   :     OUTREG32(&g_pContextRestore->BOOT_CONFIG_ADDR, 0);

  00080	e59f3104	 ldr         r3, [pc, #0x104]
  00084	e5932000	 ldr         r2, [r3]
  00088	e3a03000	 mov         r3, #0
  0008c	e5823000	 str         r3, [r2]

; 63   :     OUTREG32(&g_pContextRestore->PUBLIC_RESTORE_ADDR, 0);

  00090	e59f30f4	 ldr         r3, [pc, #0xF4]
  00094	e5933000	 ldr         r3, [r3]
  00098	e2832004	 add         r2, r3, #4
  0009c	e3a03000	 mov         r3, #0
  000a0	e5823000	 str         r3, [r2]

; 64   :     OUTREG32(&g_pContextRestore->SECURE_SRAM_RESTORE_ADDR, 0);

  000a4	e59f30e0	 ldr         r3, [pc, #0xE0]
  000a8	e5933000	 ldr         r3, [r3]
  000ac	e2832008	 add         r2, r3, #8
  000b0	e3a03000	 mov         r3, #0
  000b4	e5823000	 str         r3, [r2]

; 65   :     OUTREG32(&g_pContextRestore->SDRC_MODULE_SEMAPHORE, 0);

  000b8	e59f30cc	 ldr         r3, [pc, #0xCC]
  000bc	e5933000	 ldr         r3, [r3]
  000c0	e283200c	 add         r2, r3, #0xC
  000c4	e3a03000	 mov         r3, #0
  000c8	e5823000	 str         r3, [r2]

; 66   :     OUTREG32(&g_pContextRestore->PRCM_BLOCK_OFFSET, 0);

  000cc	e59f30b8	 ldr         r3, [pc, #0xB8]
  000d0	e5933000	 ldr         r3, [r3]
  000d4	e2832010	 add         r2, r3, #0x10
  000d8	e3a03000	 mov         r3, #0
  000dc	e5823000	 str         r3, [r2]

; 67   :     OUTREG32(&g_pContextRestore->SDRC_BLOCK_OFFSET, 0);

  000e0	e59f30a4	 ldr         r3, [pc, #0xA4]
  000e4	e5933000	 ldr         r3, [r3]
  000e8	e2832014	 add         r2, r3, #0x14
  000ec	e3a03000	 mov         r3, #0
  000f0	e5823000	 str         r3, [r2]

; 68   :     OUTREG32(&g_pContextRestore->OEM_CPU_INFO_DATA_PA, 0);

  000f4	e59f3090	 ldr         r3, [pc, #0x90]
  000f8	e5933000	 ldr         r3, [r3]
  000fc	e283201c	 add         r2, r3, #0x1C
  00100	e3a03000	 mov         r3, #0
  00104	e5823000	 str         r3, [r2]

; 69   :     OUTREG32(&g_pContextRestore->OEM_CPU_INFO_DATA_VA, 0);

  00108	e59f307c	 ldr         r3, [pc, #0x7C]
  0010c	e5933000	 ldr         r3, [r3]
  00110	e2832020	 add         r2, r3, #0x20
  00114	e3a03000	 mov         r3, #0
  00118	e5823000	 str         r3, [r2]

; 70   : 
; 71   :     // Flush the cache
; 72   :     OEMCacheRangeFlush( NULL, 0, CACHE_SYNC_ALL );

  0011c	e3a0207f	 mov         r2, #0x7F
  00120	e3a01000	 mov         r1, #0
  00124	e3a00000	 mov         r0, #0
  00128	eb000000	 bl          OEMCacheRangeFlush

; 73   : 
; 74   :     // Do warm reset
; 75   :     PrcmGlobalReset();

  0012c	eb000000	 bl          PrcmGlobalReset

; 76   : 
; 77   :     // Should never get to this point...
; 78   :     OALMSG(OAL_IOCTL&&OAL_FUNC, (L"-OALIoCtlHalReboot\r\n"));

  00130	e59f3050	 ldr         r3, [pc, #0x50]
  00134	e5933440	 ldr         r3, [r3, #0x440]
  00138	e3130a01	 tst         r3, #1, 20
  0013c	0a000008	 beq         |$LN5@OALIoCtlHa|
  00140	e59f3040	 ldr         r3, [pc, #0x40]
  00144	e5933440	 ldr         r3, [r3, #0x440]
  00148	e3130004	 tst         r3, #4
  0014c	0a000004	 beq         |$LN5@OALIoCtlHa|
  00150	e59f002c	 ldr         r0, [pc, #0x2C]
  00154	eb000000	 bl          NKDbgPrintfW
  00158	e3a03001	 mov         r3, #1
  0015c	e58d301c	 str         r3, [sp, #0x1C]
  00160	ea000001	 b           |$LN6@OALIoCtlHa|
  00164		 |$LN5@OALIoCtlHa|
  00164	e3a03000	 mov         r3, #0
  00168	e58d301c	 str         r3, [sp, #0x1C]
  0016c		 |$LN6@OALIoCtlHa|

; 79   : 
; 80   :     return TRUE;

  0016c	e3a03001	 mov         r3, #1
  00170	e58d3014	 str         r3, [sp, #0x14]

; 81   : }

  00174	e59d0014	 ldr         r0, [sp, #0x14]
  00178	e28dd020	 add         sp, sp, #0x20
  0017c	e89d6000	 ldmia       sp, {sp, lr}
  00180	e12fff1e	 bx          lr
  00184		 |$LN10@OALIoCtlHa|
  00184		 |$LN11@OALIoCtlHa|
  00184	00000000	 DCD         |??_C@_1CK@MAHBEPGM@?$AA?9?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@|
  00188		 |$LN12@OALIoCtlHa|
  00188	00000000	 DCD         |dpCurSettings|
  0018c		 |$LN13@OALIoCtlHa|
  0018c	00000000	 DCD         |g_pContextRestore|
  00190		 |$LN14@OALIoCtlHa|
  00190	01010144	 DCD         0x1010144
  00194		 |$LN15@OALIoCtlHa|
  00194	00000000	 DCD         |??_C@_1CA@PEBMPEHG@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAR?$AAE?$AAS?$AAE?$AAT?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@|
  00198		 |$LN16@OALIoCtlHa|
  00198	00000000	 DCD         |??_C@_1CK@LAAGFJIK@?$AA?$CL?$AAO?$AAA?$AAL?$AAI?$AAo?$AAC?$AAt?$AAl?$AAH?$AAa?$AAl?$AAR?$AAe?$AAb?$AAo?$AAo?$AAt?$AA?$AN?$AA?6?$AA?$AA@|
  0019c		 |$M45315|

			 ENDP  ; |OALIoCtlHalReboot|

	END
