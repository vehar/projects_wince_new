; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\AM3517\MCBSP\mcbsp.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z| ; SocMcbspDevConf
	IMPORT	|MmUnmapIoSpace|
	IMPORT	|MmMapIoSpace|

  00000			 AREA	 |.pdata|, PDATA
|$T38679| DCD	|$LN36@SocMcbspDe|
	DCD	0x4000c904
; Function compile flags: /Odtp
; File c:\wince600\platform\common\src\soc\common_ti_v1\am3517\mcbsp\mcbsp.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z| PROC ; SocMcbspDevConf

; 14   : {

  00000		 |$LN36@SocMcbspDe|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d0001	 stmdb       sp!, {r0}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd024	 sub         sp, sp, #0x24
  00010		 |$M38676|

; 15   : 	OMAP_SYSC_GENERAL_REGS* pSyscRegs = NULL;

  00010	e3a03000	 mov         r3, #0
  00014	e58d3000	 str         r3, [sp]

; 16   : 	PHYSICAL_ADDRESS pa; 
; 17   : 	DWORD val		 = 0;

  00018	e3a03000	 mov         r3, #0
  0001c	e58d3010	 str         r3, [sp, #0x10]

; 18   : 	UINT32 *pAddress = NULL;

  00020	e3a03000	 mov         r3, #0
  00024	e58d300c	 str         r3, [sp, #0xC]

; 19   : 	
; 20   : 	// Map System Control Registers
; 21   : 	pa.QuadPart = OMAP_SYSC_GENERAL_REGS_PA;

  00028	e59f32f0	 ldr         r3, [pc, #0x2F0]
  0002c	e58d3004	 str         r3, [sp, #4]
  00030	e3a03000	 mov         r3, #0
  00034	e58d3008	 str         r3, [sp, #8]

; 22   : 	pSyscRegs = (OMAP_SYSC_GENERAL_REGS*)MmMapIoSpace(
; 23   :         pa, sizeof(OMAP_SYSC_GENERAL_REGS), FALSE
; 24   :         );

  00038	e3a03000	 mov         r3, #0
  0003c	e3a02ea6	 mov         r2, #0xA6, 28
  00040	e59d0004	 ldr         r0, [sp, #4]
  00044	e59d1008	 ldr         r1, [sp, #8]
  00048	eb000000	 bl          MmMapIoSpace
  0004c	e58d0014	 str         r0, [sp, #0x14]
  00050	e59d3014	 ldr         r3, [sp, #0x14]
  00054	e58d3000	 str         r3, [sp]

; 25   : 
; 26   : 	if (pSyscRegs == NULL)

  00058	e59d3000	 ldr         r3, [sp]
  0005c	e3530000	 cmp         r3, #0
  00060	1a000000	 bne         |$LN28@SocMcbspDe|

; 27   : 	{
; 28   : 		return;

  00064	ea0000aa	 b           |$LN29@SocMcbspDe|
  00068		 |$LN28@SocMcbspDe|

; 29   : 	}
; 30   : 
; 31   :     switch (pDevice->deviceID)

  00068	e59d302c	 ldr         r3, [sp, #0x2C]
  0006c	e283300c	 add         r3, r3, #0xC
  00070	e5933000	 ldr         r3, [r3]
  00074	e58d3018	 str         r3, [sp, #0x18]
  00078	e59d3018	 ldr         r3, [sp, #0x18]
  0007c	e353002a	 cmp         r3, #0x2A
  00080	8a000009	 bhi         |$LN31@SocMcbspDe|
  00084	e59d3018	 ldr         r3, [sp, #0x18]
  00088	e353002a	 cmp         r3, #0x2A
  0008c	0a00000d	 beq         |$LN25@SocMcbspDe|
  00090	e59d3018	 ldr         r3, [sp, #0x18]
  00094	e3530003	 cmp         r3, #3
  00098	0a00000a	 beq         |$LN25@SocMcbspDe|
  0009c	e59d3018	 ldr         r3, [sp, #0x18]
  000a0	e3530004	 cmp         r3, #4
  000a4	0a00000b	 beq         |$LN24@SocMcbspDe|
  000a8	ea00000e	 b           |$LN23@SocMcbspDe|
  000ac		 |$LN31@SocMcbspDe|
  000ac	e59d3018	 ldr         r3, [sp, #0x18]
  000b0	e353002b	 cmp         r3, #0x2B
  000b4	3a00000b	 bcc         |$LN23@SocMcbspDe|
  000b8	e59d3018	 ldr         r3, [sp, #0x18]
  000bc	e353002c	 cmp         r3, #0x2C
  000c0	9a000004	 bls         |$LN24@SocMcbspDe|
  000c4	ea000007	 b           |$LN23@SocMcbspDe|
  000c8		 |$LN25@SocMcbspDe|

; 32   :     {
; 33   :         case OMAP_DEVICE_MCBSP1:
; 34   :         case OMAP_DEVICE_MCBSP2:
; 35   :             pAddress = (UINT32*)&pSyscRegs->CONTROL_DEVCONF0;

  000c8	e59d3000	 ldr         r3, [sp]
  000cc	e2833004	 add         r3, r3, #4
  000d0	e58d300c	 str         r3, [sp, #0xC]

; 36   :             break;

  000d4	ea000005	 b           |$LN26@SocMcbspDe|
  000d8		 |$LN24@SocMcbspDe|

; 37   : 
; 38   :         case OMAP_DEVICE_MCBSP3:
; 39   :         case OMAP_DEVICE_MCBSP4:
; 40   :         case OMAP_DEVICE_MCBSP5:
; 41   :             pAddress = (UINT32*)&pSyscRegs->CONTROL_DEVCONF1;

  000d8	e59d3000	 ldr         r3, [sp]
  000dc	e2833068	 add         r3, r3, #0x68
  000e0	e58d300c	 str         r3, [sp, #0xC]

; 42   :             break;

  000e4	ea000001	 b           |$LN26@SocMcbspDe|
  000e8		 |$LN23@SocMcbspDe|

; 43   : 
; 44   :         default:
; 45   :             goto cleanUp;

  000e8	ea000086	 b           |$LN22@SocMcbspDe|
  000ec	ea000085	 b           |$cleanUp$38629|
  000f0		 |$LN26@SocMcbspDe|

; 46   :             break;
; 47   :     }
; 48   : 
; 49   : 	val = INREG32(pAddress);

  000f0	e59d300c	 ldr         r3, [sp, #0xC]
  000f4	e5933000	 ldr         r3, [r3]
  000f8	e58d3010	 str         r3, [sp, #0x10]

; 50   : 
; 51   :     if (pDevice->clksPinSrc)

  000fc	e59d302c	 ldr         r3, [sp, #0x2C]
  00100	e2833f49	 add         r3, r3, #0x49, 30
  00104	e5933000	 ldr         r3, [r3]
  00108	e3530000	 cmp         r3, #0
  0010c	0a00002b	 beq         |$LN21@SocMcbspDe|

; 52   : 	{
; 53   :         switch (pDevice->deviceID)

  00110	e59d302c	 ldr         r3, [sp, #0x2C]
  00114	e283300c	 add         r3, r3, #0xC
  00118	e5933000	 ldr         r3, [r3]
  0011c	e58d301c	 str         r3, [sp, #0x1C]
  00120	e59d301c	 ldr         r3, [sp, #0x1C]
  00124	e353002a	 cmp         r3, #0x2A
  00128	8a000009	 bhi         |$LN32@SocMcbspDe|
  0012c	e59d301c	 ldr         r3, [sp, #0x1C]
  00130	e353002a	 cmp         r3, #0x2A
  00134	0a000011	 beq         |$LN17@SocMcbspDe|
  00138	e59d301c	 ldr         r3, [sp, #0x1C]
  0013c	e3530003	 cmp         r3, #3
  00140	0a00000a	 beq         |$LN18@SocMcbspDe|
  00144	e59d301c	 ldr         r3, [sp, #0x1C]
  00148	e3530004	 cmp         r3, #4
  0014c	0a000017	 beq         |$LN14@SocMcbspDe|
  00150	ea000019	 b           |$LN19@SocMcbspDe|
  00154		 |$LN32@SocMcbspDe|
  00154	e59d301c	 ldr         r3, [sp, #0x1C]
  00158	e353002b	 cmp         r3, #0x2B
  0015c	0a00000b	 beq         |$LN16@SocMcbspDe|
  00160	e59d301c	 ldr         r3, [sp, #0x1C]
  00164	e353002c	 cmp         r3, #0x2C
  00168	0a00000c	 beq         |$LN15@SocMcbspDe|
  0016c	ea000012	 b           |$LN19@SocMcbspDe|
  00170		 |$LN18@SocMcbspDe|

; 54   :         {
; 55   :         case OMAP_DEVICE_MCBSP1:
; 56   :             val |= DEVCONF0_MCBSP1_CLKS;

  00170	e59d3010	 ldr         r3, [sp, #0x10]
  00174	e3833004	 orr         r3, r3, #4
  00178	e58d3010	 str         r3, [sp, #0x10]

; 57   :             break;

  0017c	ea00000e	 b           |$LN19@SocMcbspDe|
  00180		 |$LN17@SocMcbspDe|

; 58   :         case OMAP_DEVICE_MCBSP2:
; 59   :             val |= DEVCONF0_MCBSP2_CLKS;

  00180	e59d3010	 ldr         r3, [sp, #0x10]
  00184	e3833040	 orr         r3, r3, #0x40
  00188	e58d3010	 str         r3, [sp, #0x10]

; 60   :             break;

  0018c	ea00000a	 b           |$LN19@SocMcbspDe|
  00190		 |$LN16@SocMcbspDe|

; 61   :         case OMAP_DEVICE_MCBSP3:
; 62   :             val |= DEVCONF1_MCBSP3_CLKS;

  00190	e59d3010	 ldr         r3, [sp, #0x10]
  00194	e3833001	 orr         r3, r3, #1
  00198	e58d3010	 str         r3, [sp, #0x10]

; 63   :             break;

  0019c	ea000006	 b           |$LN19@SocMcbspDe|
  001a0		 |$LN15@SocMcbspDe|

; 64   :         case OMAP_DEVICE_MCBSP4:
; 65   :             val |= DEVCONF1_MCBSP4_CLKS;

  001a0	e59d3010	 ldr         r3, [sp, #0x10]
  001a4	e3833004	 orr         r3, r3, #4
  001a8	e58d3010	 str         r3, [sp, #0x10]

; 66   :             break;

  001ac	ea000002	 b           |$LN19@SocMcbspDe|
  001b0		 |$LN14@SocMcbspDe|

; 67   :         case OMAP_DEVICE_MCBSP5:
; 68   :             val |= DEVCONF1_MCBSP5_CLKS;

  001b0	e59d3010	 ldr         r3, [sp, #0x10]
  001b4	e3833010	 orr         r3, r3, #0x10
  001b8	e58d3010	 str         r3, [sp, #0x10]
  001bc		 |$LN19@SocMcbspDe|

; 69   :             break;
; 70   :         }
; 71   : 	}
; 72   :     else

  001bc	ea00002f	 b           |$LN13@SocMcbspDe|
  001c0		 |$LN21@SocMcbspDe|

; 73   : 	{
; 74   :         switch (pDevice->deviceID)

  001c0	e59d302c	 ldr         r3, [sp, #0x2C]
  001c4	e283300c	 add         r3, r3, #0xC
  001c8	e5933000	 ldr         r3, [r3]
  001cc	e58d3020	 str         r3, [sp, #0x20]
  001d0	e59d3020	 ldr         r3, [sp, #0x20]
  001d4	e353002a	 cmp         r3, #0x2A
  001d8	8a000009	 bhi         |$LN33@SocMcbspDe|
  001dc	e59d3020	 ldr         r3, [sp, #0x20]
  001e0	e353002a	 cmp         r3, #0x2A
  001e4	0a000012	 beq         |$LN9@SocMcbspDe|
  001e8	e59d3020	 ldr         r3, [sp, #0x20]
  001ec	e3530003	 cmp         r3, #3
  001f0	0a00000a	 beq         |$LN10@SocMcbspDe|
  001f4	e59d3020	 ldr         r3, [sp, #0x20]
  001f8	e3530004	 cmp         r3, #4
  001fc	0a00001b	 beq         |$LN6@SocMcbspDe|
  00200	ea00001e	 b           |$LN11@SocMcbspDe|
  00204		 |$LN33@SocMcbspDe|
  00204	e59d3020	 ldr         r3, [sp, #0x20]
  00208	e353002b	 cmp         r3, #0x2B
  0020c	0a00000d	 beq         |$LN8@SocMcbspDe|
  00210	e59d3020	 ldr         r3, [sp, #0x20]
  00214	e353002c	 cmp         r3, #0x2C
  00218	0a00000f	 beq         |$LN7@SocMcbspDe|
  0021c	ea000017	 b           |$LN11@SocMcbspDe|
  00220		 |$LN10@SocMcbspDe|

; 75   :         {
; 76   :         case OMAP_DEVICE_MCBSP1:
; 77   :             val &= ~DEVCONF0_MCBSP1_CLKS;

  00220	e59d2010	 ldr         r2, [sp, #0x10]
  00224	e3e03004	 mvn         r3, #4
  00228	e0023003	 and         r3, r2, r3
  0022c	e58d3010	 str         r3, [sp, #0x10]

; 78   :             break;

  00230	ea000012	 b           |$LN11@SocMcbspDe|
  00234		 |$LN9@SocMcbspDe|

; 79   :         case OMAP_DEVICE_MCBSP2:
; 80   :             val &= ~DEVCONF0_MCBSP2_CLKS;

  00234	e59d2010	 ldr         r2, [sp, #0x10]
  00238	e3e03040	 mvn         r3, #0x40
  0023c	e0023003	 and         r3, r2, r3
  00240	e58d3010	 str         r3, [sp, #0x10]

; 81   :             break;

  00244	ea00000d	 b           |$LN11@SocMcbspDe|
  00248		 |$LN8@SocMcbspDe|

; 82   :         case OMAP_DEVICE_MCBSP3:
; 83   :             val &= ~DEVCONF1_MCBSP3_CLKS;

  00248	e59d2010	 ldr         r2, [sp, #0x10]
  0024c	e3e03001	 mvn         r3, #1
  00250	e0023003	 and         r3, r2, r3
  00254	e58d3010	 str         r3, [sp, #0x10]

; 84   :             break;

  00258	ea000008	 b           |$LN11@SocMcbspDe|
  0025c		 |$LN7@SocMcbspDe|

; 85   :         case OMAP_DEVICE_MCBSP4:
; 86   :             val &= ~DEVCONF1_MCBSP4_CLKS;

  0025c	e59d2010	 ldr         r2, [sp, #0x10]
  00260	e3e03004	 mvn         r3, #4
  00264	e0023003	 and         r3, r2, r3
  00268	e58d3010	 str         r3, [sp, #0x10]

; 87   :             break;

  0026c	ea000003	 b           |$LN11@SocMcbspDe|
  00270		 |$LN6@SocMcbspDe|

; 88   :         case OMAP_DEVICE_MCBSP5:
; 89   :             val &= ~DEVCONF1_MCBSP5_CLKS;

  00270	e59d2010	 ldr         r2, [sp, #0x10]
  00274	e3e03010	 mvn         r3, #0x10
  00278	e0023003	 and         r3, r2, r3
  0027c	e58d3010	 str         r3, [sp, #0x10]
  00280		 |$LN11@SocMcbspDe|
  00280		 |$LN13@SocMcbspDe|

; 90   :             break;
; 91   :         }
; 92   : 	}
; 93   : 
; 94   : 	// Special case for McBSP1
; 95   : 	if (pDevice->deviceID == OMAP_DEVICE_MCBSP1)

  00280	e59d302c	 ldr         r3, [sp, #0x2C]
  00284	e283300c	 add         r3, r3, #0xC
  00288	e5933000	 ldr         r3, [r3]
  0028c	e3530003	 cmp         r3, #3
  00290	1a000019	 bne         |$LN5@SocMcbspDe|

; 96   : 	{
; 97   : 		if (pDevice->clockModeRx)

  00294	e59d302c	 ldr         r3, [sp, #0x2C]
  00298	e28330fc	 add         r3, r3, #0xFC
  0029c	e5933000	 ldr         r3, [r3]
  002a0	e3530000	 cmp         r3, #0
  002a4	0a000003	 beq         |$LN4@SocMcbspDe|

; 98   : 		{
; 99   : 			val |= DEVCONF0_MCBSP1_CLKR;			

  002a8	e59d3010	 ldr         r3, [sp, #0x10]
  002ac	e3833008	 orr         r3, r3, #8
  002b0	e58d3010	 str         r3, [sp, #0x10]

; 100  : 		}
; 101  : 		else

  002b4	ea000003	 b           |$LN3@SocMcbspDe|
  002b8		 |$LN4@SocMcbspDe|

; 102  : 		{
; 103  : 			val &= ~DEVCONF0_MCBSP1_CLKR;

  002b8	e59d2010	 ldr         r2, [sp, #0x10]
  002bc	e3e03008	 mvn         r3, #8
  002c0	e0023003	 and         r3, r2, r3
  002c4	e58d3010	 str         r3, [sp, #0x10]
  002c8		 |$LN3@SocMcbspDe|

; 104  : 		}
; 105  : 
; 106  : 		if (pDevice->frameSyncSourceRx)

  002c8	e59d302c	 ldr         r3, [sp, #0x2C]
  002cc	e2833c01	 add         r3, r3, #1, 24
  002d0	e5933000	 ldr         r3, [r3]
  002d4	e3530000	 cmp         r3, #0
  002d8	0a000003	 beq         |$LN2@SocMcbspDe|

; 107  : 		{
; 108  : 			val |= DEVCONF0_MCBSP1_FSR;

  002dc	e59d3010	 ldr         r3, [sp, #0x10]
  002e0	e3833010	 orr         r3, r3, #0x10
  002e4	e58d3010	 str         r3, [sp, #0x10]

; 109  : 		}
; 110  : 		else

  002e8	ea000003	 b           |$LN1@SocMcbspDe|
  002ec		 |$LN2@SocMcbspDe|

; 111  : 		{
; 112  : 			val &= ~DEVCONF0_MCBSP1_FSR;

  002ec	e59d2010	 ldr         r2, [sp, #0x10]
  002f0	e3e03010	 mvn         r3, #0x10
  002f4	e0023003	 and         r3, r2, r3
  002f8	e58d3010	 str         r3, [sp, #0x10]
  002fc		 |$LN1@SocMcbspDe|
  002fc		 |$LN5@SocMcbspDe|

; 113  : 		}
; 114  : 	}
; 115  : 
; 116  :     OUTREG32(pAddress, val);

  002fc	e59d2010	 ldr         r2, [sp, #0x10]
  00300	e59d300c	 ldr         r3, [sp, #0xC]
  00304	e5832000	 str         r2, [r3]
  00308		 |$LN22@SocMcbspDe|
  00308		 |$cleanUp$38629|

; 117  : 
; 118  : cleanUp:
; 119  : 
; 120  : 	MmUnmapIoSpace((PVOID)pSyscRegs, sizeof(OMAP_SYSC_GENERAL_REGS));

  00308	e3a01ea6	 mov         r1, #0xA6, 28
  0030c	e59d0000	 ldr         r0, [sp]
  00310	eb000000	 bl          MmUnmapIoSpace
  00314		 |$LN29@SocMcbspDe|

; 121  : }

  00314	e28dd024	 add         sp, sp, #0x24
  00318	e89d6000	 ldmia       sp, {sp, lr}
  0031c	e12fff1e	 bx          lr
  00320		 |$LN37@SocMcbspDe|
  00320		 |$LN38@SocMcbspDe|
  00320	48002270	 DCD         0x48002270
  00324		 |$M38677|

			 ENDP  ; |?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z|, SocMcbspDevConf

	END
