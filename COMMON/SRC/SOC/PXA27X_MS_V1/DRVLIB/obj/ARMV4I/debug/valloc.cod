; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\PXA27X_MS_V1\DRVLIB\valloc.c
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|??_C@_1HA@KONPLMBB@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAa?$AAd?$AAd?$AAr?$AA?$DN?$AA0?$AAx@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FM@EHIGNDGI@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?$DN?$AA0@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CI@OHCJFJPM@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?5?$AAl?$AAi?$AAn?$AAe?$AA?5?$AA?$CF?$AAd?$AA?3?$AA?5?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1IG@FHHHJKOA@?$AAC?$AA?3?$AA?2?$AAW?$AAI?$AAN?$AAC?$AAE?$AA6?$AA0?$AA0?$AA?2?$AAP?$AAL?$AAA?$AAT?$AAF?$AAO?$AAR?$AAM?$AA?2?$AAC?$AAO?$AAM?$AAM?$AAO?$AAN?$AA?2?$AAS?$AAR?$AAC?$AA?2@| [ DATA ] ; `string'
	EXPORT	|VirtualAllocCopy|
	IMPORT	|VirtualCopy|
	IMPORT	|GetLastError|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|VirtualAlloc|

  00000			 AREA	 |.pdata|, PDATA
|$T38990| DCD	|$LN9@VirtualAll|
	DCD	0x40005504
; File c:\wince600\platform\common\src\soc\pxa27x_ms_v1\drvlib\valloc.c

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HA@KONPLMBB@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAa?$AAd?$AAd?$AAr?$AA?$DN?$AA0?$AAx@| DCB "V"
	DCB	0x0, "i", 0x0, "r", 0x0, "t", 0x0, "u", 0x0, "a", 0x0, "l"
	DCB	0x0, "C", 0x0, "o", 0x0, "p", 0x0, "y", 0x0, " ", 0x0, "f"
	DCB	0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d", 0x0, "!"
	DCB	0x0, " ", 0x0, "%", 0x0, "s", 0x0, " ", 0x0, ":", 0x0, " "
	DCB	0x0, "a", 0x0, "d", 0x0, "d", 0x0, "r", 0x0, "=", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "x", 0x0, ",", 0x0, " ", 0x0, "o"
	DCB	0x0, "f", 0x0, "f", 0x0, "s", 0x0, "e", 0x0, "t", 0x0, "="
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, "(", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "x", 0x0, ")", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FM@EHIGNDGI@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?$DN?$AA0@| DCB "V"
	DCB	0x0, "i", 0x0, "r", 0x0, "t", 0x0, "u", 0x0, "a", 0x0, "l"
	DCB	0x0, "A", 0x0, "l", 0x0, "l", 0x0, "o", 0x0, "c", 0x0, " "
	DCB	0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d"
	DCB	0x0, "!", 0x0, " ", 0x0, "%", 0x0, "s", 0x0, " ", 0x0, ":"
	DCB	0x0, " ", 0x0, "s", 0x0, "i", 0x0, "z", 0x0, "e", 0x0, "="
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, ",", 0x0, " "
	DCB	0x0, "(", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, ")"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CI@OHCJFJPM@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?5?$AAl?$AAi?$AAn?$AAe?$AA?5?$AA?$CF?$AAd?$AA?3?$AA?5?$AA?$AA@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "%", 0x0, "s", 0x0, " ", 0x0, "l", 0x0, "i", 0x0, "n"
	DCB	0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, ":", 0x0, " "
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1IG@FHHHJKOA@?$AAC?$AA?3?$AA?2?$AAW?$AAI?$AAN?$AAC?$AAE?$AA6?$AA0?$AA0?$AA?2?$AAP?$AAL?$AAA?$AAT?$AAF?$AAO?$AAR?$AAM?$AA?2?$AAC?$AAO?$AAM?$AAM?$AAO?$AAN?$AA?2?$AAS?$AAR?$AAC?$AA?2@| DCB "C"
	DCB	0x0, ":", 0x0, "\\", 0x0, "W", 0x0, "I", 0x0, "N", 0x0, "C"
	DCB	0x0, "E", 0x0, "6", 0x0, "0", 0x0, "0", 0x0, "\\", 0x0, "P"
	DCB	0x0, "L", 0x0, "A", 0x0, "T", 0x0, "F", 0x0, "O", 0x0, "R"
	DCB	0x0, "M", 0x0, "\\", 0x0, "C", 0x0, "O", 0x0, "M", 0x0, "M"
	DCB	0x0, "O", 0x0, "N", 0x0, "\\", 0x0, "S", 0x0, "R", 0x0, "C"
	DCB	0x0, "\\", 0x0, "S", 0x0, "O", 0x0, "C", 0x0, "\\", 0x0, "P"
	DCB	0x0, "X", 0x0, "A", 0x0, "2", 0x0, "7", 0x0, "X", 0x0, "_"
	DCB	0x0, "M", 0x0, "S", 0x0, "_", 0x0, "V", 0x0, "1", 0x0, "\\"
	DCB	0x0, "D", 0x0, "R", 0x0, "V", 0x0, "L", 0x0, "I", 0x0, "B"
	DCB	0x0, "\\", 0x0, ".", 0x0, "\\", 0x0, "v", 0x0, "a", 0x0, "l"
	DCB	0x0, "l", 0x0, "o", 0x0, "c", 0x0, ".", 0x0, "c", 0x0, 0x0
	DCB	0x0					; `string'
; Function compile flags: /Odtp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |VirtualAllocCopy| PROC

; 36   : {

  00000		 |$LN9@VirtualAll|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d0007	 stmdb       sp!, {r0 - r2}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd028	 sub         sp, sp, #0x28
  00010		 |$M38987|

; 37   :     PVOID ptr;
; 38   :     unsigned offset;
; 39   : 
; 40   :     offset = (unsigned)pVirtualAddress & ALIGNMENT_MASK;

  00010	e59d2038	 ldr         r2, [sp, #0x38]
  00014	e3a03c0f	 mov         r3, #0xF, 24
  00018	e38330ff	 orr         r3, r3, #0xFF
  0001c	e0023003	 and         r3, r2, r3
  00020	e58d3008	 str         r3, [sp, #8]

; 41   : 
; 42   :     size +=offset ? PAGE_SIZE : 0;

  00024	e59d3008	 ldr         r3, [sp, #8]
  00028	e3530000	 cmp         r3, #0
  0002c	0a000002	 beq         |$LN5@VirtualAll|
  00030	e3a03a01	 mov         r3, #1, 20
  00034	e58d3014	 str         r3, [sp, #0x14]
  00038	ea000001	 b           |$LN6@VirtualAll|
  0003c		 |$LN5@VirtualAll|
  0003c	e3a03000	 mov         r3, #0
  00040	e58d3014	 str         r3, [sp, #0x14]
  00044		 |$LN6@VirtualAll|
  00044	e59d2030	 ldr         r2, [sp, #0x30]
  00048	e59d3014	 ldr         r3, [sp, #0x14]
  0004c	e0823003	 add         r3, r2, r3
  00050	e58d3030	 str         r3, [sp, #0x30]

; 43   :     ptr = VirtualAlloc(0,size,MEM_RESERVE,PAGE_NOACCESS);

  00054	e3a03001	 mov         r3, #1
  00058	e3a02a02	 mov         r2, #2, 20
  0005c	e59d1030	 ldr         r1, [sp, #0x30]
  00060	e3a00000	 mov         r0, #0
  00064	eb000000	 bl          VirtualAlloc
  00068	e58d0018	 str         r0, [sp, #0x18]
  0006c	e59d3018	 ldr         r3, [sp, #0x18]
  00070	e58d3004	 str         r3, [sp, #4]

; 44   :     if (ptr == NULL)

  00074	e59d3004	 ldr         r3, [sp, #4]
  00078	e3530000	 cmp         r3, #0
  0007c	1a00000d	 bne         |$LN2@VirtualAll|

; 45   :     {
; 46   :         ERRORMSG(1,(TEXT("VirtualAlloc failed! %s : size=0x%x, (0x%x)\r\n"),str,size,GetLastError()));

  00080	e3a0202e	 mov         r2, #0x2E
  00084	e59f10c0	 ldr         r1, [pc, #0xC0]
  00088	e59f00b8	 ldr         r0, [pc, #0xB8]
  0008c	eb000000	 bl          NKDbgPrintfW
  00090	eb000000	 bl          GetLastError
  00094	e58d001c	 str         r0, [sp, #0x1C]
  00098	e59d301c	 ldr         r3, [sp, #0x1C]
  0009c	e59d2030	 ldr         r2, [sp, #0x30]
  000a0	e59d1034	 ldr         r1, [sp, #0x34]
  000a4	e59f00a4	 ldr         r0, [pc, #0xA4]
  000a8	eb000000	 bl          NKDbgPrintfW

; 47   :         return(0);

  000ac	e3a03000	 mov         r3, #0
  000b0	e58d300c	 str         r3, [sp, #0xC]
  000b4	ea00001e	 b           |$LN3@VirtualAll|
  000b8		 |$LN2@VirtualAll|

; 48   :     }
; 49   : 
; 50   :     if (!VirtualCopy((PVOID)ptr,(PVOID)((unsigned)pVirtualAddress - offset),size,PAGE_READWRITE|PAGE_NOCACHE))

  000b8	e3a03f81	 mov         r3, #0x81, 30
  000bc	e59d2030	 ldr         r2, [sp, #0x30]
  000c0	e59d0038	 ldr         r0, [sp, #0x38]
  000c4	e59d1008	 ldr         r1, [sp, #8]
  000c8	e0401001	 sub         r1, r0, r1
  000cc	e59d0004	 ldr         r0, [sp, #4]
  000d0	eb000000	 bl          VirtualCopy
  000d4	e58d0020	 str         r0, [sp, #0x20]
  000d8	e59d3020	 ldr         r3, [sp, #0x20]
  000dc	e3530000	 cmp         r3, #0
  000e0	1a00000f	 bne         |$LN1@VirtualAll|

; 51   :     {
; 52   :         ERRORMSG(1,(TEXT("VirtualCopy failed! %s : addr=0x%x, offset=0x%x(0x%x)\r\n"),str,(unsigned)pVirtualAddress,offset,GetLastError()));

  000e4	e3a02034	 mov         r2, #0x34
  000e8	e59f105c	 ldr         r1, [pc, #0x5C]
  000ec	e59f0054	 ldr         r0, [pc, #0x54]
  000f0	eb000000	 bl          NKDbgPrintfW
  000f4	eb000000	 bl          GetLastError
  000f8	e58d0024	 str         r0, [sp, #0x24]
  000fc	e59d3024	 ldr         r3, [sp, #0x24]
  00100	e58d3000	 str         r3, [sp]
  00104	e59d3008	 ldr         r3, [sp, #8]
  00108	e59d2038	 ldr         r2, [sp, #0x38]
  0010c	e59d1034	 ldr         r1, [sp, #0x34]
  00110	e59f002c	 ldr         r0, [pc, #0x2C]
  00114	eb000000	 bl          NKDbgPrintfW

; 53   :         return(0);

  00118	e3a03000	 mov         r3, #0
  0011c	e58d300c	 str         r3, [sp, #0xC]
  00120	ea000003	 b           |$LN3@VirtualAll|
  00124		 |$LN1@VirtualAll|

; 54   :     }
; 55   :     return((PVOID)((PBYTE)ptr+offset));

  00124	e59d2004	 ldr         r2, [sp, #4]
  00128	e59d3008	 ldr         r3, [sp, #8]
  0012c	e0823003	 add         r3, r2, r3
  00130	e58d300c	 str         r3, [sp, #0xC]
  00134		 |$LN3@VirtualAll|

; 56   : }

  00134	e59d000c	 ldr         r0, [sp, #0xC]
  00138	e28dd028	 add         sp, sp, #0x28
  0013c	e89d6000	 ldmia       sp, {sp, lr}
  00140	e12fff1e	 bx          lr
  00144		 |$LN10@VirtualAll|
  00144		 |$LN11@VirtualAll|
  00144	00000000	 DCD         |??_C@_1HA@KONPLMBB@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAa?$AAd?$AAd?$AAr?$AA?$DN?$AA0?$AAx@|
  00148		 |$LN12@VirtualAll|
  00148	00000000	 DCD         |??_C@_1CI@OHCJFJPM@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?5?$AAl?$AAi?$AAn?$AAe?$AA?5?$AA?$CF?$AAd?$AA?3?$AA?5?$AA?$AA@|
  0014c		 |$LN13@VirtualAll|
  0014c	00000000	 DCD         |??_C@_1IG@FHHHJKOA@?$AAC?$AA?3?$AA?2?$AAW?$AAI?$AAN?$AAC?$AAE?$AA6?$AA0?$AA0?$AA?2?$AAP?$AAL?$AAA?$AAT?$AAF?$AAO?$AAR?$AAM?$AA?2?$AAC?$AAO?$AAM?$AAM?$AAO?$AAN?$AA?2?$AAS?$AAR?$AAC?$AA?2@|
  00150		 |$LN14@VirtualAll|
  00150	00000000	 DCD         |??_C@_1FM@EHIGNDGI@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5?$AA?$CF?$AAs?$AA?5?$AA?3?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?$DN?$AA0@|
  00154		 |$M38988|

			 ENDP  ; |VirtualAllocCopy|

	EXPORT	|??_C@_1II@OGOOAFNE@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5@| [ DATA ] ; `string'
	EXPORT	|??_C@_1HE@NJMOAGKK@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB@| [ DATA ] ; `string'
	EXPORT	|VirtualAllocCopyPhysical|

  00008			 AREA	 |.pdata|, PDATA
|$T39004| DCD	|$LN9@VirtualAll@2|
	DCD	0x40005704

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1II@OGOOAFNE@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5@| DCB "V"
	DCB	0x0, "i", 0x0, "r", 0x0, "t", 0x0, "u", 0x0, "a", 0x0, "l"
	DCB	0x0, "C", 0x0, "o", 0x0, "p", 0x0, "y", 0x0, "C", 0x0, "o"
	DCB	0x0, "p", 0x0, "y", 0x0, "P", 0x0, "h", 0x0, "y", 0x0, "s"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "l", 0x0, " ", 0x0, "f"
	DCB	0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d", 0x0, "!"
	DCB	0x0, " ", 0x0, "%", 0x0, "s", 0x0, " ", 0x0, ":", 0x0, " "
	DCB	0x0, "a", 0x0, "d", 0x0, "d", 0x0, "r", 0x0, "=", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "x", 0x0, ",", 0x0, " ", 0x0, "o"
	DCB	0x0, "f", 0x0, "f", 0x0, "s", 0x0, "e", 0x0, "t", 0x0, "="
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, "(", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "x", 0x0, ")", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HE@NJMOAGKK@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB@| DCB "V"
	DCB	0x0, "i", 0x0, "r", 0x0, "t", 0x0, "u", 0x0, "a", 0x0, "l"
	DCB	0x0, "A", 0x0, "l", 0x0, "l", 0x0, "o", 0x0, "c", 0x0, "C"
	DCB	0x0, "o", 0x0, "p", 0x0, "y", 0x0, "P", 0x0, "h", 0x0, "y"
	DCB	0x0, "s", 0x0, "i", 0x0, "c", 0x0, "a", 0x0, "l", 0x0, " "
	DCB	0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d"
	DCB	0x0, "!", 0x0, " ", 0x0, "%", 0x0, "s", 0x0, " ", 0x0, ":"
	DCB	0x0, " ", 0x0, "s", 0x0, "i", 0x0, "z", 0x0, "e", 0x0, "="
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, ",", 0x0, " "
	DCB	0x0, "(", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "x", 0x0, ")"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'
; Function compile flags: /Odtp

  00154			 AREA	 |.text|, CODE, ARM

  00154		 |VirtualAllocCopyPhysical| PROC

; 60   : {

  00154		 |$LN9@VirtualAll@2|
  00154	e1a0c00d	 mov         r12, sp
  00158	e92d0007	 stmdb       sp!, {r0 - r2}
  0015c	e92d5000	 stmdb       sp!, {r12, lr}
  00160	e24dd028	 sub         sp, sp, #0x28
  00164		 |$M39001|

; 61   :     PVOID ptr;
; 62   :     unsigned offset;
; 63   : 
; 64   :     offset = (unsigned)pPhysicalAddress & ALIGNMENT_MASK;

  00164	e59d2038	 ldr         r2, [sp, #0x38]
  00168	e3a03c0f	 mov         r3, #0xF, 24
  0016c	e38330ff	 orr         r3, r3, #0xFF
  00170	e0023003	 and         r3, r2, r3
  00174	e58d3008	 str         r3, [sp, #8]

; 65   : 
; 66   :     size +=offset ? PAGE_SIZE : 0;

  00178	e59d3008	 ldr         r3, [sp, #8]
  0017c	e3530000	 cmp         r3, #0
  00180	0a000002	 beq         |$LN5@VirtualAll@2|
  00184	e3a03a01	 mov         r3, #1, 20
  00188	e58d3014	 str         r3, [sp, #0x14]
  0018c	ea000001	 b           |$LN6@VirtualAll@2|
  00190		 |$LN5@VirtualAll@2|
  00190	e3a03000	 mov         r3, #0
  00194	e58d3014	 str         r3, [sp, #0x14]
  00198		 |$LN6@VirtualAll@2|
  00198	e59d2030	 ldr         r2, [sp, #0x30]
  0019c	e59d3014	 ldr         r3, [sp, #0x14]
  001a0	e0823003	 add         r3, r2, r3
  001a4	e58d3030	 str         r3, [sp, #0x30]

; 67   :     ptr = VirtualAlloc(0, size, MEM_RESERVE, PAGE_NOACCESS);

  001a8	e3a03001	 mov         r3, #1
  001ac	e3a02a02	 mov         r2, #2, 20
  001b0	e59d1030	 ldr         r1, [sp, #0x30]
  001b4	e3a00000	 mov         r0, #0
  001b8	eb000000	 bl          VirtualAlloc
  001bc	e58d0018	 str         r0, [sp, #0x18]
  001c0	e59d3018	 ldr         r3, [sp, #0x18]
  001c4	e58d3004	 str         r3, [sp, #4]

; 68   : 
; 69   :     if (ptr == NULL)

  001c8	e59d3004	 ldr         r3, [sp, #4]
  001cc	e3530000	 cmp         r3, #0
  001d0	1a00000d	 bne         |$LN2@VirtualAll@2|

; 70   :     {
; 71   :         ERRORMSG(1,(TEXT("VirtualAllocCopyPhysical failed! %s : size=0x%x, (0x%x)\r\n"),str,size,GetLastError()));

  001d4	e3a02047	 mov         r2, #0x47
  001d8	e59f10c8	 ldr         r1, [pc, #0xC8]
  001dc	e59f00c0	 ldr         r0, [pc, #0xC0]
  001e0	eb000000	 bl          NKDbgPrintfW
  001e4	eb000000	 bl          GetLastError
  001e8	e58d001c	 str         r0, [sp, #0x1C]
  001ec	e59d301c	 ldr         r3, [sp, #0x1C]
  001f0	e59d2030	 ldr         r2, [sp, #0x30]
  001f4	e59d1034	 ldr         r1, [sp, #0x34]
  001f8	e59f00ac	 ldr         r0, [pc, #0xAC]
  001fc	eb000000	 bl          NKDbgPrintfW

; 72   :         return(0);

  00200	e3a03000	 mov         r3, #0
  00204	e58d300c	 str         r3, [sp, #0xC]
  00208	ea000020	 b           |$LN3@VirtualAll@2|
  0020c		 |$LN2@VirtualAll@2|

; 73   :     }
; 74   : 
; 75   :     if (!VirtualCopy((PVOID)ptr, (PVOID)(((unsigned)pPhysicalAddress - offset) >> 8), size, PAGE_PHYSICAL | PAGE_READWRITE | PAGE_NOCACHE))

  0020c	e3a03c06	 mov         r3, #6, 24
  00210	e3833004	 orr         r3, r3, #4
  00214	e59d2030	 ldr         r2, [sp, #0x30]
  00218	e59d0038	 ldr         r0, [sp, #0x38]
  0021c	e59d1008	 ldr         r1, [sp, #8]
  00220	e0401001	 sub         r1, r0, r1
  00224	e1a01421	 mov         r1, r1, lsr #8
  00228	e59d0004	 ldr         r0, [sp, #4]
  0022c	eb000000	 bl          VirtualCopy
  00230	e58d0020	 str         r0, [sp, #0x20]
  00234	e59d3020	 ldr         r3, [sp, #0x20]
  00238	e3530000	 cmp         r3, #0
  0023c	1a00000f	 bne         |$LN1@VirtualAll@2|

; 76   :     {
; 77   :         ERRORMSG(1,(TEXT("VirtualCopyCopyPhysical failed! %s : addr=0x%x, offset=0x%x(0x%x)\r\n"),str,(unsigned)pPhysicalAddress,offset,GetLastError()));

  00240	e3a0204d	 mov         r2, #0x4D
  00244	e59f105c	 ldr         r1, [pc, #0x5C]
  00248	e59f0054	 ldr         r0, [pc, #0x54]
  0024c	eb000000	 bl          NKDbgPrintfW
  00250	eb000000	 bl          GetLastError
  00254	e58d0024	 str         r0, [sp, #0x24]
  00258	e59d3024	 ldr         r3, [sp, #0x24]
  0025c	e58d3000	 str         r3, [sp]
  00260	e59d3008	 ldr         r3, [sp, #8]
  00264	e59d2038	 ldr         r2, [sp, #0x38]
  00268	e59d1034	 ldr         r1, [sp, #0x34]
  0026c	e59f002c	 ldr         r0, [pc, #0x2C]
  00270	eb000000	 bl          NKDbgPrintfW

; 78   :         return(0);

  00274	e3a03000	 mov         r3, #0
  00278	e58d300c	 str         r3, [sp, #0xC]
  0027c	ea000003	 b           |$LN3@VirtualAll@2|
  00280		 |$LN1@VirtualAll@2|

; 79   :     }
; 80   :     return((PVOID)((PBYTE)ptr+offset));

  00280	e59d2004	 ldr         r2, [sp, #4]
  00284	e59d3008	 ldr         r3, [sp, #8]
  00288	e0823003	 add         r3, r2, r3
  0028c	e58d300c	 str         r3, [sp, #0xC]
  00290		 |$LN3@VirtualAll@2|

; 81   : }

  00290	e59d000c	 ldr         r0, [sp, #0xC]
  00294	e28dd028	 add         sp, sp, #0x28
  00298	e89d6000	 ldmia       sp, {sp, lr}
  0029c	e12fff1e	 bx          lr
  002a0		 |$LN10@VirtualAll@2|
  002a0		 |$LN11@VirtualAll@2|
  002a0	00000000	 DCD         |??_C@_1II@OGOOAFNE@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAC?$AAo?$AAp?$AAy?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?5@|
  002a4		 |$LN12@VirtualAll@2|
  002a4	00000000	 DCD         |??_C@_1CI@OHCJFJPM@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?5?$AAl?$AAi?$AAn?$AAe?$AA?5?$AA?$CF?$AAd?$AA?3?$AA?5?$AA?$AA@|
  002a8		 |$LN13@VirtualAll@2|
  002a8	00000000	 DCD         |??_C@_1IG@FHHHJKOA@?$AAC?$AA?3?$AA?2?$AAW?$AAI?$AAN?$AAC?$AAE?$AA6?$AA0?$AA0?$AA?2?$AAP?$AAL?$AAA?$AAT?$AAF?$AAO?$AAR?$AAM?$AA?2?$AAC?$AAO?$AAM?$AAM?$AAO?$AAN?$AA?2?$AAS?$AAR?$AAC?$AA?2@|
  002ac		 |$LN14@VirtualAll@2|
  002ac	00000000	 DCD         |??_C@_1HE@NJMOAGKK@?$AAV?$AAi?$AAr?$AAt?$AAu?$AAa?$AAl?$AAA?$AAl?$AAl?$AAo?$AAc?$AAC?$AAo?$AAp?$AAy?$AAP?$AAh?$AAy?$AAs?$AAi?$AAc?$AAa?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB@|
  002b0		 |$M39002|

			 ENDP  ; |VirtualAllocCopyPhysical|

	END
