; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\PXA27X_MS_V1\DISPLAY\PXA27X_LCD\halcaps.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?cbDDCallbacks@@3U_DDHAL_DDCALLBACKS@@A| [ DATA ] ; cbDDCallbacks
	EXPORT	|?cbDDSurfaceCallbacks@@3U_DDHAL_DDSURFACECALLBACKS@@A| [ DATA ] ; cbDDSurfaceCallbacks
	EXPORT	|?g_nVideoMemorySize@@3KA| [ DATA ]	; g_nVideoMemorySize
	EXPORT	|?g_pVideoMemory@@3PAEA| [ DATA ]	; g_pVideoMemory
	EXPORT	|?g_nTransparentColor@@3KA| [ DATA ]	; g_nTransparentColor
	IMPORT	|DDGPESetColorKey|
	IMPORT	|DDGPEUnlock|
	IMPORT	|DDGPELock|
	IMPORT	|DDGPEDestroySurface|
	IMPORT	|DDGPECanCreateSurface|
	IMPORT	|DDGPEWaitForVerticalBlank|
	IMPORT	|DDGPECreateSurface|

  00000			 AREA	 |.bss|, NOINIT
|?g_nVideoMemorySize@@3KA| % 0x4			; g_nVideoMemorySize
|?g_pVideoMemory@@3PAEA| % 0x4				; g_pVideoMemory
|?g_nTransparentColor@@3KA| % 0x4			; g_nTransparentColor

  00000			 AREA	 |.data|, DATA
|?cbDDCallbacks@@3U_DDHAL_DDCALLBACKS@@A| DCD 0x1c	; cbDDCallbacks
	DCD	0x7
	DCD	|DDGPECreateSurface|
	DCD	|DDGPEWaitForVerticalBlank|
	DCD	|DDGPECanCreateSurface|
	DCD	0x0
	DCD	0x0
|?cbDDSurfaceCallbacks@@3U_DDHAL_DDSURFACECALLBACKS@@A| DCD 0x30 ; cbDDSurfaceCallbacks
	DCD	0x1d
	DCD	|DDGPEDestroySurface|
	DCD	0x0
	DCD	|DDGPELock|
	DCD	|DDGPEUnlock|
	DCD	|DDGPESetColorKey|
	DCD	0x0
	DCD	0x0
	DCD	0x0
	DCD	0x0
	DCD	0x0

  00000			 AREA	 |.rdata|, DATA, READONLY
|FourCCDescriptionTable| DCD 0x32595559
	DCD	0x10
	DCD	0xff00ff
	DCD	0xff00
	DCD	0xff000000
	DCD	0x56595559
	DCD	0x10
	DCD	0xff00ff
	DCD	0xff00
	DCD	0xff000000
	DCD	0x55595659
	DCD	0x10
	DCD	0xff00ff00
	DCD	0xff
	DCD	0xff0000
	DCD	0x59565955
	DCD	0x10
	DCD	0xff00ff00
	DCD	0xff
	DCD	0xff0000
	DCD	0x36315659
	DCD	0x10
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x32315659
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x3231564e
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x30323449
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x56555949
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	EXPORT	|?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z| ; HalGetDriverInfo
; File c:\wince600\platform\common\src\soc\pxa27x_ms_v1\display\pxa27x_lcd\halcaps.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T36167| DCD	|$LN5@HalGetDriv|
	DCD	0x40000600
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z| PROC ; HalGetDriverInfo

; 82   : {

  00000		 |$LN5@HalGetDriv|
  00000		 |$M36164|
  00000	e1a02000	 mov         r2, r0

; 83   :     DEBUGENTER( HalGetDriverInfo );
; 84   : 
; 85   :     lpInput->ddRVal = DDERR_CURRENTLYNOTAVAIL;

  00004	e59f3008	 ldr         r3, [pc, #8]

; 86   : 
; 87   :     DEBUGLEAVE( HalGetDriverInfo );
; 88   : 
; 89   :     return (DDHAL_DRIVER_HANDLED);

  00008	e3a00001	 mov         r0, #1
  0000c	e5823028	 str         r3, [r2, #0x28]

; 90   : }

  00010	e12fff1e	 bx          lr
  00014		 |$LN6@HalGetDriv|
  00014		 |$LN7@HalGetDriv|
  00014	88760028	 DCD         0x88760028
  00018		 |$M36165|

			 ENDP  ; |?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z|, HalGetDriverInfo

	EXPORT	|buildDDHALInfo|
	IMPORT	|?GetVirtualVideoMemory@SA2Video@@QAAXPAK0@Z| ; SA2Video::GetVirtualVideoMemory
	IMPORT	|?GetDDGPE@@YAPAVDDGPE@@XZ|		; GetDDGPE
	IMPORT	|memset|

  00000			 AREA	 |.pdata|, PDATA
|$T36179| DCD	|$LN6@buildDDHAL|
	DCD	0x40003502
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |buildDDHALInfo| PROC

; 93   : {

  00000		 |$LN6@buildDDHAL|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004	e24dd004	 sub         sp, sp, #4
  00008		 |$M36176|
  00008	e1a05000	 mov         r5, r0

; 94   :     memset( lpddhi, 0, sizeof(DDHALINFO) );

  0000c	e3a02f47	 mov         r2, #0x47, 30
  00010	e3a01000	 mov         r1, #0
  00014	eb000000	 bl          memset

; 95   : 
; 96   :     SA2Video * pSA2Video = (SA2Video *)GetDDGPE();

  00018	eb000000	 bl          |?GetDDGPE@@YAPAVDDGPE@@XZ|

; 97   : 
; 98   :     if ( !g_pVideoMemory )   // in case this is called more than once...

  0001c	e59f40ac	 ldr         r4, [pc, #0xAC]
  00020	e5943004	 ldr         r3, [r4, #4]
  00024	e3530000	 cmp         r3, #0
  00028	1a000004	 bne         |$LN1@buildDDHAL|

; 99   :     {
; 100  :         unsigned long VideoMemoryStart;
; 101  :         pSA2Video->GetVirtualVideoMemory( &VideoMemoryStart, &g_nVideoMemorySize );

  0002c	e1a02004	 mov         r2, r4
  00030	e28d1000	 add         r1, sp, #0
  00034	eb000000	 bl          |?GetVirtualVideoMemory@SA2Video@@QAAXPAK0@Z|

; 102  :         DEBUGMSG( GPE_ZONE_INIT,(TEXT("GetVirtualVideoMemory returned addr=0x%08x size=%d\r\n"), VideoMemoryStart, g_nVideoMemorySize));
; 103  : 
; 104  :         g_pVideoMemory = (BYTE*)VideoMemoryStart;

  00038	e59d3000	 ldr         r3, [sp]
  0003c	e5843004	 str         r3, [r4, #4]
  00040		 |$LN1@buildDDHAL|

; 105  :         DEBUGMSG( GPE_ZONE_INIT,(TEXT("gpVidMem=%08x\r\n"), g_pVideoMemory ));
; 106  :     }
; 107  : 
; 108  :     lpddhi->dwSize = sizeof(DDHALINFO);
; 109  : 
; 110  :     lpddhi->lpDDCallbacks = &cbDDCallbacks;

  00040	e59f2084	 ldr         r2, [pc, #0x84]

; 111  :     lpddhi->lpDDSurfaceCallbacks = &cbDDSurfaceCallbacks;
; 112  :     
; 113  :     lpddhi->GetDriverInfo = HalGetDriverInfo;

  00044	e59f107c	 ldr         r1, [pc, #0x7C]
  00048	e3a00f47	 mov         r0, #0x47, 30
  0004c	e282301c	 add         r3, r2, #0x1C

; 114  : 
; 115  :     lpddhi->ddCaps.dwSize = sizeof(DDCAPS);

  00050	e3a0e080	 mov         lr, #0x80
  00054	e585300c	 str         r3, [r5, #0xC]
  00058	e5850000	 str         r0, [r5]
  0005c	e5852008	 str         r2, [r5, #8]
  00060	e5851014	 str         r1, [r5, #0x14]
  00064	e585e018	 str         lr, [r5, #0x18]

; 116  : 
; 117  :     lpddhi->ddCaps.dwVidMemTotal = g_nVideoMemorySize;

  00068	e5943000	 ldr         r3, [r4]

; 118  :     lpddhi->ddCaps.dwVidMemFree = g_nVideoMemorySize;
; 119  :     lpddhi->ddCaps.ddsCaps.dwCaps=
; 120  : 		DDSCAPS_PRIMARYSURFACE |
; 121  : 		DDSCAPS_SYSTEMMEMORY |
; 122  : 		0;
; 123  : 
; 124  :     lpddhi->ddCaps.dwPalCaps=
; 125  : 		DDPCAPS_PRIMARYSURFACE |
; 126  : 		0;
; 127  : 
; 128  :     lpddhi->ddCaps.dwBltCaps =
; 129  :         DDBLTCAPS_READSYSMEM |
; 130  :         DDBLTCAPS_WRITESYSMEM |
; 131  :         0;
; 132  : 
; 133  :     SETROPBIT(lpddhi->ddCaps.dwRops,SRCCOPY);                   // Set bits for ROPS supported

  0006c	e5952058	 ldr         r2, [r5, #0x58]

; 134  :     SETROPBIT(lpddhi->ddCaps.dwRops,PATCOPY);
; 135  :     SETROPBIT(lpddhi->ddCaps.dwRops,BLACKNESS);

  00070	e5951040	 ldr         r1, [r5, #0x40]

; 136  :     SETROPBIT(lpddhi->ddCaps.dwRops,WHITENESS);

  00074	e595e05c	 ldr         lr, [r5, #0x5C]
  00078	e585301c	 str         r3, [r5, #0x1C]
  0007c	e3a03102	 mov         r3, #2, 2
  00080	e5940000	 ldr         r0, [r4]
  00084	e3833801	 orr         r3, r3, #1, 16
  00088	e18e3003	 orr         r3, lr, r3
  0008c	e3a040c0	 mov         r4, #0xC0
  00090	e3a06010	 mov         r6, #0x10
  00094	e3a07003	 mov         r7, #3
  00098	e3822a01	 orr         r2, r2, #1, 20
  0009c	e3811001	 orr         r1, r1, #1
  000a0	e585305c	 str         r3, [r5, #0x5C]
  000a4	e5850020	 str         r0, [r5, #0x20]
  000a8	e5854028	 str         r4, [r5, #0x28]
  000ac	e5856030	 str         r6, [r5, #0x30]
  000b0	e5857034	 str         r7, [r5, #0x34]
  000b4	e5852058	 str         r2, [r5, #0x58]
  000b8	e5851040	 str         r1, [r5, #0x40]

; 137  : }

  000bc	e28dd004	 add         sp, sp, #4
  000c0	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  000c4	e12fff1e	 bx          lr
  000c8		 |$LN7@buildDDHAL|
  000c8		 |$LN8@buildDDHAL|
  000c8	00000000	 DCD         |?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z|
  000cc		 |$LN9@buildDDHAL|
  000cc	00000000	 DCD         |?cbDDCallbacks@@3U_DDHAL_DDCALLBACKS@@A|
  000d0		 |$LN10@buildDDHAL|
  000d0	00000000	 DCD         |?g_nVideoMemorySize@@3KA|
  000d4		 |$M36177|

			 ENDP  ; |buildDDHALInfo|

	END
