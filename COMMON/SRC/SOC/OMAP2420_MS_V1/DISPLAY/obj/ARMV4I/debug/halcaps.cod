; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\OMAP2420_MS_V1\DISPLAY\halcaps.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?aFourCC@@3PAKA| [ DATA ]		; aFourCC
	IMPORT	|DDGPESetPalette|
	IMPORT	|?HalSetOverlayPosition@@YAKPAU_DDHAL_SETOVERLAYPOSITIONDATA@@@Z| ; HalSetOverlayPosition
	IMPORT	|?HalUpdateOverlay@@YAKPAU_DDHAL_UPDATEOVERLAYDATA@@@Z| ; HalUpdateOverlay
	IMPORT	|?HalGetFlipStatus@@YAKPAU_DDHAL_GETFLIPSTATUSDATA@@@Z| ; HalGetFlipStatus
	IMPORT	|?HalGetBltStatus@@YAKPAU_DDHAL_GETBLTSTATUSDATA@@@Z| ; HalGetBltStatus
	IMPORT	|DDGPESetColorKey|
	IMPORT	|?HalUnlock@@YAKPAU_DDHAL_UNLOCKDATA@@@Z| ; HalUnlock
	IMPORT	|?HalLock@@YAKPAU_DDHAL_LOCKDATA@@@Z|	; HalLock
	IMPORT	|?HalFlip@@YAKPAU_DDHAL_FLIPDATA@@@Z|	; HalFlip
	IMPORT	|DDGPEDestroySurface|
	IMPORT	|DDGPESetEntries|
	IMPORT	|DDGPEDestroyPalette|
	IMPORT	|DDGPECreatePalette|
	IMPORT	|DDGPECanCreateSurface|
	IMPORT	|DDGPECreateSurface|

  00000			 AREA	 |.data|, DATA
|?aFourCC@@3PAKA| DCD 0x59565955			; aFourCC
|cbDDCallbacks| DCD 0x1c
	DCD	0xd
	DCD	|DDGPECreateSurface|
	DCD	0x0
	DCD	|DDGPECanCreateSurface|
	DCD	|DDGPECreatePalette|
	DCD	0x0
|MiscellaneousCallbacks| DCD 0x10
	DCD	0x0
	DCD	0x0
	DCD	0x0
|cbDDPaletteCallbacks| DCD 0x10
	DCD	0x3
	DCD	|DDGPEDestroyPalette|
	DCD	|DDGPESetEntries|
|cbDDSurfaceCallbacks| DCD 0x30
	DCD	0x3ff
	DCD	|DDGPEDestroySurface|
	DCD	|?HalFlip@@YAKPAU_DDHAL_FLIPDATA@@@Z|
	DCD	|?HalLock@@YAKPAU_DDHAL_LOCKDATA@@@Z|
	DCD	|?HalUnlock@@YAKPAU_DDHAL_UNLOCKDATA@@@Z|
	DCD	|DDGPESetColorKey|
	DCD	|?HalGetBltStatus@@YAKPAU_DDHAL_GETBLTSTATUSDATA@@@Z|
	DCD	|?HalGetFlipStatus@@YAKPAU_DDHAL_GETFLIPSTATUSDATA@@@Z|
	DCD	|?HalUpdateOverlay@@YAKPAU_DDHAL_UPDATEOVERLAYDATA@@@Z|
	DCD	|?HalSetOverlayPosition@@YAKPAU_DDHAL_SETOVERLAYPOSITIONDATA@@@Z|
	DCD	|DDGPESetPalette|

  00000			 AREA	 |.rdata|, DATA, READONLY
|FourCCDescriptionTable| DCD 0x32595559
	DCD	0x10
	DCD	0xff00ff
	DCD	0xff00
	DCD	0xff000000
	DCD	0x56595559
	DCD	0x10
	DCD	0xff00ff
	DCD	0xff00
	DCD	0xff000000
	DCD	0x55595659
	DCD	0x10
	DCD	0xff00ff00
	DCD	0xff
	DCD	0xff0000
	DCD	0x59565955
	DCD	0x10
	DCD	0xff00ff00
	DCD	0xff
	DCD	0xff0000
	DCD	0x36315659
	DCD	0x10
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x32315659
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x3231564e
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x30323449
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0x56555949
	DCD	0xc
	DCD	0xffffffff
	DCD	0xffffffff
	DCD	0xffffffff
	EXPORT	|?BuildDDHALInfo@OMAP2420GPE@@QAAXPAU_DDHALINFO@@K@Z| ; OMAP2420GPE::BuildDDHALInfo
	EXPORT	|buildDDHALInfo|
	IMPORT	|?GetDDGPE@@YAPAVDDGPE@@XZ|		; GetDDGPE

  00000			 AREA	 |.pdata|, PDATA
|$T40263| DCD	|$LN5@buildDDHAL|
	DCD	0x40000f04
; Function compile flags: /Odtp
; File c:\wince600\platform\common\src\soc\omap2420_ms_v1\display\halcaps.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |buildDDHALInfo| PROC

; 101  : {

  00000		 |$LN5@buildDDHAL|
  00000	e1a0c00d	 mov         r12, sp
  00004	e92d0003	 stmdb       sp!, {r0, r1}
  00008	e92d5000	 stmdb       sp!, {r12, lr}
  0000c	e24dd008	 sub         sp, sp, #8
  00010		 |$M40260|

; 102  :     OMAP2420GPE *pOMAP2420GPE = static_cast<OMAP2420GPE*>(GetDDGPE());

  00010	eb000000	 bl          |?GetDDGPE@@YAPAVDDGPE@@XZ|
  00014	e58d0004	 str         r0, [sp, #4]
  00018	e59d3004	 ldr         r3, [sp, #4]
  0001c	e58d3000	 str         r3, [sp]

; 103  :     pOMAP2420GPE->BuildDDHALInfo(lpddhi, modeIdx);

  00020	e59d2014	 ldr         r2, [sp, #0x14]
  00024	e59d1010	 ldr         r1, [sp, #0x10]
  00028	e59d0000	 ldr         r0, [sp]
  0002c	eb000000	 bl          |?BuildDDHALInfo@OMAP2420GPE@@QAAXPAU_DDHALINFO@@K@Z|

; 104  : }

  00030	e28dd008	 add         sp, sp, #8
  00034	e89d6000	 ldmia       sp, {sp, lr}
  00038	e12fff1e	 bx          lr
  0003c		 |$M40261|

			 ENDP  ; |buildDDHALInfo|

	IMPORT	|?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z| ; HalGetDriverInfo
	IMPORT	|memset|

  00008			 AREA	 |.pdata|, PDATA
|$T40268| DCD	|$LN5@BuildDDHAL|
	DCD	0x40007503
; Function compile flags: /Odtp

  0003c			 AREA	 |.text|, CODE, ARM

  0003c		 |?BuildDDHALInfo@OMAP2420GPE@@QAAXPAU_DDHALINFO@@K@Z| PROC ; OMAP2420GPE::BuildDDHALInfo

; 111  : {

  0003c		 |$LN5@BuildDDHAL|
  0003c	e1a0c00d	 mov         r12, sp
  00040	e92d0007	 stmdb       sp!, {r0 - r2}
  00044	e92d5000	 stmdb       sp!, {r12, lr}
  00048		 |$M40265|

; 112  :     // clear the DDHALINFO structure and set the sizes
; 113  :     memset(pInfo, 0, sizeof(DDHALINFO));

  00048	e3a02f47	 mov         r2, #0x47, 30
  0004c	e3a01000	 mov         r1, #0
  00050	e59d000c	 ldr         r0, [sp, #0xC]
  00054	eb000000	 bl          memset

; 114  :     pInfo->dwSize = sizeof(DDHALINFO);

  00058	e59d200c	 ldr         r2, [sp, #0xC]
  0005c	e3a03f47	 mov         r3, #0x47, 30
  00060	e5823000	 str         r3, [r2]

; 115  :     pInfo->ddCaps.dwSize = sizeof(DDCAPS);

  00064	e59d300c	 ldr         r3, [sp, #0xC]
  00068	e2832018	 add         r2, r3, #0x18
  0006c	e3a03080	 mov         r3, #0x80
  00070	e5823000	 str         r3, [r2]

; 116  : 
; 117  :     // set the callback pointers
; 118  :     pInfo->lpDDCallbacks = &cbDDCallbacks;

  00074	e59d300c	 ldr         r3, [sp, #0xC]
  00078	e2832008	 add         r2, r3, #8
  0007c	e59f3188	 ldr         r3, [pc, #0x188]
  00080	e5823000	 str         r3, [r2]

; 119  :     pInfo->lpDDSurfaceCallbacks = &cbDDSurfaceCallbacks;

  00084	e59d300c	 ldr         r3, [sp, #0xC]
  00088	e283200c	 add         r2, r3, #0xC
  0008c	e59f3174	 ldr         r3, [pc, #0x174]
  00090	e5823000	 str         r3, [r2]

; 120  :     pInfo->lpDDPaletteCallbacks = &cbDDPaletteCallbacks;

  00094	e59d300c	 ldr         r3, [sp, #0xC]
  00098	e2832010	 add         r2, r3, #0x10
  0009c	e59f3160	 ldr         r3, [pc, #0x160]
  000a0	e5823000	 str         r3, [r2]

; 121  :     pInfo->GetDriverInfo = HalGetDriverInfo;

  000a4	e59d300c	 ldr         r3, [sp, #0xC]
  000a8	e2832014	 add         r2, r3, #0x14
  000ac	e59f314c	 ldr         r3, [pc, #0x14C]
  000b0	e5823000	 str         r3, [r2]

; 122  : 
; 123  :     // set the video memory sizes
; 124  :     pInfo->ddCaps.dwVidMemTotal = VIDEO_MEMORY_SIZE;

  000b4	e59d300c	 ldr         r3, [sp, #0xC]
  000b8	e283201c	 add         r2, r3, #0x1C
  000bc	e3a03401	 mov         r3, #1, 8
  000c0	e5823000	 str         r3, [r2]

; 125  :     pInfo->ddCaps.dwVidMemFree = VIDEO_MEMORY_SIZE;

  000c4	e59d300c	 ldr         r3, [sp, #0xC]
  000c8	e2832020	 add         r2, r3, #0x20
  000cc	e3a03401	 mov         r3, #1, 8
  000d0	e5823000	 str         r3, [r2]

; 126  : 
; 127  :     // set the overlay info
; 128  : //    pInfo->ddCaps.dwMaxVisibleOverlays = 1;
; 129  :     pInfo->ddCaps.dwCurrVisibleOverlays = 0;

  000d4	e59d300c	 ldr         r3, [sp, #0xC]
  000d8	e2832068	 add         r2, r3, #0x68
  000dc	e3a03000	 mov         r3, #0
  000e0	e5823000	 str         r3, [r2]

; 130  :     //	pInfo->ddCaps.dwMinOverlayStretch = 500;
; 131  :     //	pInfo->ddCaps.dwMaxOverlayStretch = 8000;
; 132  :     pInfo->ddCaps.dwMinOverlayStretch = 1000;

  000e4	e59d300c	 ldr         r3, [sp, #0xC]
  000e8	e283207c	 add         r2, r3, #0x7C
  000ec	e3a03ffa	 mov         r3, #0xFA, 30
  000f0	e5823000	 str         r3, [r2]

; 133  :     pInfo->ddCaps.dwMaxOverlayStretch = 1000;

  000f4	e59d300c	 ldr         r3, [sp, #0xC]
  000f8	e2832080	 add         r2, r3, #0x80
  000fc	e3a03ffa	 mov         r3, #0xFA, 30
  00100	e5823000	 str         r3, [r2]

; 134  : 
; 135  :     // set some misc info
; 136  :     pInfo->ddCaps.dwNumFourCCCodes = 0; //NUM_FOURCC_CODES;

  00104	e59d300c	 ldr         r3, [sp, #0xC]
  00108	e283202c	 add         r2, r3, #0x2C
  0010c	e3a03000	 mov         r3, #0
  00110	e5823000	 str         r3, [r2]

; 137  :     pInfo->ddCaps.dwAlignBoundarySrc = 0;

  00114	e59d300c	 ldr         r3, [sp, #0xC]
  00118	e283206c	 add         r2, r3, #0x6C
  0011c	e3a03000	 mov         r3, #0
  00120	e5823000	 str         r3, [r2]

; 138  :     pInfo->ddCaps.dwAlignSizeSrc = 0;

  00124	e59d300c	 ldr         r3, [sp, #0xC]
  00128	e2832070	 add         r2, r3, #0x70
  0012c	e3a03000	 mov         r3, #0
  00130	e5823000	 str         r3, [r2]

; 139  : //    pInfo->lpdwFourCC = aFourCC;
; 140  :     pInfo->dwFlags = 0;

  00134	e59d300c	 ldr         r3, [sp, #0xC]
  00138	e2832004	 add         r2, r3, #4
  0013c	e3a03000	 mov         r3, #0
  00140	e5823000	 str         r3, [r2]

; 141  :     
; 142  :     // set the general surface capabilities
; 143  :     pInfo->ddCaps.ddsCaps.dwCaps = (DDSCAPS_BACKBUFFER|
; 144  :                                     DDSCAPS_FLIP|
; 145  :                                     DDSCAPS_FRONTBUFFER|
; 146  : //                                    DDSCAPS_OVERLAY|
; 147  :                                     DDSCAPS_PRIMARYSURFACE|
; 148  :                                     DDSCAPS_SYSTEMMEMORY|
; 149  :                                     DDSCAPS_VIDEOMEMORY|
; 150  :                                     0);

  00144	e59d300c	 ldr         r3, [sp, #0xC]
  00148	e2832028	 add         r2, r3, #0x28
  0014c	e3a03c01	 mov         r3, #1, 24
  00150	e38330ce	 orr         r3, r3, #0xCE
  00154	e5823000	 str         r3, [r2]

; 151  : 
; 152  :     // set the color key capabilities of the surface
; 153  :     pInfo->ddCaps.dwCKeyCaps = DDCKEYCAPS_SRCBLT|
; 154  :                                //DDCKEYCAPS_DESTBLT|
; 155  :                                0;

  00158	e59d300c	 ldr         r3, [sp, #0xC]
  0015c	e2832038	 add         r2, r3, #0x38
  00160	e3a03c02	 mov         r3, #2, 24
  00164	e5823000	 str         r3, [r2]

; 156  : 
; 157  :     // set the palette capabilities
; 158  :     pInfo->ddCaps.dwPalCaps = 0; // DDPCAPS_PRIMARYSURFACE

  00168	e59d300c	 ldr         r3, [sp, #0xC]
  0016c	e2832030	 add         r2, r3, #0x30
  00170	e3a03000	 mov         r3, #0
  00174	e5823000	 str         r3, [r2]

; 159  : 
; 160  :     // set the BLT capabilities
; 161  :     pInfo->ddCaps.dwBltCaps = DDBLTCAPS_READSYSMEM | DDBLTCAPS_WRITESYSMEM;

  00178	e59d300c	 ldr         r3, [sp, #0xC]
  0017c	e2832034	 add         r2, r3, #0x34
  00180	e3a03003	 mov         r3, #3
  00184	e5823000	 str         r3, [r2]

; 162  : 
; 163  :     // set the overlay capabilities
; 164  :     //pInfo->ddCaps.dwOverlayCaps = DDOVERLAYCAPS_OVERLAYSUPPORT|DDOVERLAYCAPS_FLIP|DDOVERLAYCAPS_CKEYSRC|DDOVERLAYCAPS_CKEYDEST;
; 165  : 
; 166  :     // set the supported ROPS
; 167  :     SETROPBIT(pInfo->ddCaps.dwRops, SRCCOPY);

  00188	e59d300c	 ldr         r3, [sp, #0xC]
  0018c	e2833058	 add         r3, r3, #0x58
  00190	e5933000	 ldr         r3, [r3]
  00194	e3832a01	 orr         r2, r3, #1, 20
  00198	e59d300c	 ldr         r3, [sp, #0xC]
  0019c	e2833058	 add         r3, r3, #0x58
  001a0	e5832000	 str         r2, [r3]

; 168  :     SETROPBIT(pInfo->ddCaps.dwRops, PATCOPY);

  001a4	e59d300c	 ldr         r3, [sp, #0xC]
  001a8	e283305c	 add         r3, r3, #0x5C
  001ac	e5933000	 ldr         r3, [r3]
  001b0	e3832801	 orr         r2, r3, #1, 16
  001b4	e59d300c	 ldr         r3, [sp, #0xC]
  001b8	e283305c	 add         r3, r3, #0x5C
  001bc	e5832000	 str         r2, [r3]

; 169  :     SETROPBIT(pInfo->ddCaps.dwRops, BLACKNESS);

  001c0	e59d300c	 ldr         r3, [sp, #0xC]
  001c4	e2833040	 add         r3, r3, #0x40
  001c8	e5933000	 ldr         r3, [r3]
  001cc	e3832001	 orr         r2, r3, #1
  001d0	e59d300c	 ldr         r3, [sp, #0xC]
  001d4	e2833040	 add         r3, r3, #0x40
  001d8	e5832000	 str         r2, [r3]

; 170  :     SETROPBIT(pInfo->ddCaps.dwRops, WHITENESS);

  001dc	e59d300c	 ldr         r3, [sp, #0xC]
  001e0	e283305c	 add         r3, r3, #0x5C
  001e4	e5933000	 ldr         r3, [r3]
  001e8	e3832102	 orr         r2, r3, #2, 2
  001ec	e59d300c	 ldr         r3, [sp, #0xC]
  001f0	e283305c	 add         r3, r3, #0x5C
  001f4	e5832000	 str         r2, [r3]

; 171  : }

  001f8	e89d6000	 ldmia       sp, {sp, lr}
  001fc	e12fff1e	 bx          lr
  00200		 |$LN6@BuildDDHAL|
  00200		 |$LN7@BuildDDHAL|
  00200	00000000	 DCD         |?HalGetDriverInfo@@YAKPAU_DDHAL_GETDRIVERINFODATA@@@Z|
  00204		 |$LN8@BuildDDHAL|
  00204	00000000	 DCD         |cbDDPaletteCallbacks|
  00208		 |$LN9@BuildDDHAL|
  00208	00000000	 DCD         |cbDDSurfaceCallbacks|
  0020c		 |$LN10@BuildDDHAL|
  0020c	00000000	 DCD         |cbDDCallbacks|
  00210		 |$M40266|

			 ENDP  ; |?BuildDDHALInfo@OMAP2420GPE@@QAAXPAU_DDHALINFO@@K@Z|, OMAP2420GPE::BuildDDHALInfo

	END
